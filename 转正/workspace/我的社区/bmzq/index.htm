<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>便民专区</title>

</head>

<body background="images/bg.jpg" leftmargin="0" topmargin="0">
    <div style="position:absolute; left:72px; top:64px;"><img src="images/logo.png" width="168" height="34" /></div>
    <div id="title" style="position:absolute; left:251px; top:67px; font-size:26px; color:#ffffff;">便民专区</div>

    <div id="into0" style="position:absolute;width: 320px;height: 440px; left:75px; top:142px;box-shadow: 0 0 4px 4px #ffa400;"><img src="images/pic4_01.jpg" width="320" height="440" /></div>
    <div id="into1" style="position:absolute; left:399px; top:142px;"><img src="images/pic4_02.jpg" width="320" height="292" /></div>
    <div id="into2" style="position:absolute; left:723px; top:142px;"><img src="images/pic4_04.jpg" width="320" height="292" /></div>

    <div id="into3" style="position:absolute; left:1047px; top:142px;"><img src="images/pic4_05.jpg" width="158" height="292" /></div>

    <div id="into4" style="position:absolute; left:399px; top:438px;"><img src="images/pic4_03.jpg" width="320" height="144" /></div>
    <div id="into5" style="position:absolute; left:723px; top:438px;"><img src="images/pic4_06.jpg" width="482" height="144" /></div>

    <div style="position:absolute; left:75px; top:648px;"><img src="images/icon1_01.png" width="23" height="20" /></div>
    <div style="position:absolute; left:108px; top:646px; font-size:22px; color:#a7b9d4;">6月20日上午，山东省发布的《生产经营单位安全生产不良...</div>
    <div style="position:absolute; left:995px; top:644px;"><img src="images/icon1_02.png" width="25" height="26" /></div>
    <div style="position:absolute; left:1028px; top:646px;font-size:22px; color:#a7b9d4;">客服热线：96123</div>

    <script type="text/javascript" src="common.js"></script>
    <script>
        var pos = 0;
        var menuData = [];
        var ajaxObj = null;

        function focusMove() {
            empty();
            $("into" + pos).style.boxShadow = "0 0 4px 4px #ffa400"
        }

        function empty() {
            for (var i = 0; i < 6; i++) {
                $("into" + i).style.boxShadow = ""
            }
        }

        function keyUp() {
            if (pos > 0 && pos < 3) {
                pos += 3;
            } else if (pos == 3) {
                pos += 2;
            } else if (pos > 3) {
                pos -= 3;
            }
            focusMove();
        }

        function keyDown() {
            if (pos > 0 && pos < 3) {
                pos += 3;
            } else if (pos == 3) {
                pos += 2;
            } else if (pos > 3) {
                pos -= 3;
            }
            focusMove();
        }

        function keyLeft() {
            if (pos == 0) {
                pos = 5;
            } else {
                pos--;
            }
            focusMove();
        }

        function keyRight() {
            if (pos == 5) {
                pos = 0;
            } else {
                pos++;
            }
            focusMove();

        }

        function doSelect() {
            window.location.href = menuData[pos].enName + "/index.htm";
        }

        function getMenuData() {
            if (ajaxObj != null) {
                ajaxObj.requestAbort();
            }
            ajaxObj = new ajaxClass();
            ajaxObj.frame = window;
            ajaxObj.charset = "utf-8";
            ajaxObj.successCallback = function(_xmlHttp, _params) {
                var jsonData = eval('(' + _xmlHttp.responseText + ')');
                menuData = jsonData;
            };
            ajaxObj.failureCallback = function(_xmlHttp, _params) {};
            ajaxObj.url = "menu.js";
            ajaxObj.requestData();
        }
        document.onkeydown = eventHandler;

        function eventHandler(event) {
            var e = e || event;
            var keycode = e.keyCode || e.which || e.charCode;
            // var eventObj = Event.mapping(keycode);    
            switch (keycode) {
                case 38: //up
                    keyUp()
                    return false;
                    break;
                case 40: //down
                    keyDown();
                    return false;
                    break;
                case 37: //left
                    keyLeft();
                    return false;
                    break;
                case 39: //right
                    keyRight();
                    return false;
                    break;
                case 13:
                    doSelect();
                    return false;
                    break;
                case 8:
                    goBack();
                    return false;
                    break;
                case 513: //menu
                    exitWidget();
                    break;
                case 512: //homepage
                    goBack();
                    return false;
                    break;
                default:
                    break;

            }

        };

        function init() {
            getMenuData();
        }

        window.onload = init()
    </script>

</body>

</html>