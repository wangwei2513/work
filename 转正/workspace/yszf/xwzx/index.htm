<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>新闻中心</title>
    <script type="text/javascript" src="js/common.js"></script>
    <script type="text/javascript" src="js/keyevent.js"></script>
    <script type="text/javascript">
        document.onkeydown = eventHandler;

        function eventHandler(e) {
            var e = e || event;
            var keycode = e.keyCode || e.which || e.charCode;
            var eventObj = Event.mapping(keycode);
            switch (eventObj.code) {
                case "KEY_UP":
                    changeUD(-1);
                    return false;
                    break;
                case "KEY_DOWN":
                    changeUD(1);
                    return false;
                    break;
                case "KEY_LEFT":
                    changeLR(-1);
                    return false;
                    break;
                case "KEY_RIGHT":
                    changeLR(1);
                    return false;
                    break;
                case "KEY_SELECT":
                    doSelect();
                    return false;
                    break;
                case "KEY_EXIT":
                case "KEY_BACK":
                    window.location.href = "../pt/index.htm";
                    removeGlobalParms([enName + "_listPos", enName + "_menuPos", enName + "_focusArea"]);
                    return false;
                    break;
            }
        }
        /**************************变量**************************/
        var menuData = [];
        var contentData = [];
        var menuPos = 0;
        var listPos = 0;
        var focusArea = 0;
        var leftCurrPage = 1;
        var leftTotalPage = 1;
        var leftPageSize = 5;
        var rightCurrPage = 1;
        var rightTotalPage = 1;
        var rightPageSize = 9;

        var ajaxObj = null;
        var nodeFile = "node.js";
        var file = "menu.js";
        var contentFile = "content.js";
        var enName = "";
        var adPoster = "images/ad.png";
        /**************************方法**************************/
        function init() {
            initParams();
            ajaxMenuList();
            onMenuFocus();
        }


        function initParams() {
            menuPos = parseInt(getUrlParams("menuPos"), 10) || parseInt(getGlobalParms(enName + "_menuPos"), 10) || parseInt(menuPos, 10) || 0;
            leftCurrPage = Math.floor(menuPos / leftPageSize) + 1;
            menuPos = menuPos % leftPageSize;

            listPos = parseInt(getUrlParams("listPos"), 10) || parseInt(getGlobalParms(enName + "_listPos"), 10) || parseInt(listPos, 10) || 0;
            rightCurrPage = Math.floor(listPos / rightPageSize) + 1;
            listPos = listPos % rightPageSize;

        }

        function ajaxMenuList() {
            if (ajaxObj == null) {
                ajaxObj = new ajaxClass();
                ajaxObj.charset = "gbk";
                ajaxObj.frame = window;
            } else {
                ajaxObj.requestAbort();
            }

            var url = file;
            ajaxObj.url = url;

            ajaxObj.successCallback = function(_xmlHttp) {
                var getData = eval("(" + _xmlHttp.responseText + ")");
                menuData = getData;
                initMenu();
            }

            ajaxObj.failureCallback = function() {
                initMenu();
            }

            ajaxObj.requestData();
        }

        function initMenu() {
            clearMenu();
            if (menuData.length > 0) {
                leftTotalPage = Math.ceil(menuData.length / leftPageSize);
                for (var i = 0; i < Math.min(leftPageSize, menuData.length - (leftCurrPage - 1) * leftPageSize); i++) {
                    $("menu_bg" + i).src = "images/menu_bg1.png";
                    $("menu_bg" + i).innerText = getStrChineseLen(menuData[i + (leftCurrPage - 1) * leftPageSize].name, 6);
                }
            }
            ajaxContentList();
        }

        function clearMenu() {
            for (var i = 0; i < leftPageSize; i++) {
                $("menu_bg" + i).src = "images/clear.gif";
                $("menu_bg" + i).innerText = "";
            }
        }

        function ajaxContentList() {
            if (!menuData[menuPos + (leftCurrPage - 1) * leftPageSize]) {
                return false;
            }

            if (ajaxObj == null) {
                ajaxObj = new ajaxClass();
                ajaxObj.charset = "gbk";
                ajaxObj.frame = window;
            } else {
                ajaxObj.requestAbort();
            }

            var url = menuData[menuPos + (leftCurrPage - 1) * leftPageSize].enName + '/' + contentFile;
            console.log(menuData)
            ajaxObj.url = url;

            ajaxObj.successCallback = function(_xmlHttp) {
                var getData = eval("(" + _xmlHttp.responseText + ")");
                contentData = getData;
                initContent();
                onFocus();
            }

            ajaxObj.failureCallback = function() {
                initContent();
                onFocus();
            }

            ajaxObj.requestData();
        }

        function initContent() {
            clearContent();
            if (contentData.length > 0) {
                rightTotalPage = Math.ceil(contentData.length / rightPageSize);
                $("totlePage").innerHTML = rightTotalPage;
                $("currPage").innerHTML = rightCurrPage;
                for (var i = 0; i < Math.min(rightPageSize, contentData.length - (rightCurrPage - 1) * rightPageSize); i++) {
                    $("list_name" + i).innerText = getStrChineseLen(contentData[i + (rightCurrPage - 1) * rightPageSize].title, 18);
                    $("list_time" + i).innerText = contentData[i + (rightCurrPage - 1) * rightPageSize].date;
                }
            }
        }

        function clearContent() {
            for (var i = 0; i < rightPageSize; i++) {
                $("list_name" + i).innerText = "";
                $("list_time" + i).innerText = "";
            }
        }


        function onFocus() {
            switch (focusArea) {
                case 0:
                    onMenuFocus();
                    loseContentFocus();
                    break;
                case 1:
                    onContentFocus();
                    loseMenuFocus();
                    break;
                default:
                    break;
            }
        }

        /*
         *左侧列表获取和失去焦点
         */
        function onMenuFocus() {
            $("menu_bg" + menuPos).style.background = "url(images/list_zfbg1_f1.png)";
            $("menu_bg" + menuPos).style.color = "#ffffff";
        }

        function loseMenuFocus() {
            $("menu_bg" + menuPos).style.background = "url(images/list_zfbg1.png)";
            $("menu_bg" + menuPos).style.color = "#000000";
        }

        function onContentFocus() {
            $("newsCenterRightListFocus").style.display = "block";
            $("newsCenterRightListFocus").style.top = -2 + 54 * listPos + "px";
            if (getStrChineseLength(contentData[listPos + (rightCurrPage - 1) * rightPageSize].title) > 19) {
                $("list_name" + listPos).innerHTML = "<marquee style='width:520px'>" + contentData[listPos + (rightCurrPage - 1) * rightPageSize].title + "</marquee>";
            }
            var pos = listPos + (rightCurrPage - 1) * rightPageSize;
            var focusData = {};
            focusData[enName + "_listPos"] = pos;
            focusData[enName + "_focusArea"] = focusArea;
            setGlobalParms(focusData);
        }




        function loseContentFocus() {
            $("newsCenterRightListFocus").style.display = "none";
            $("list_name" + listPos).innerText = getStrChineseLen(contentData[listPos + (rightCurrPage - 1) * rightPageSize].title, 18);
        }

        function changeUD(_num) {
            if (focusArea == 0) {
                if (menuData.length <= 0) {
                    return false;
                }
                loseMenuFocus();
                if ((menuPos == 0 && leftCurrPage == 1 && _num == -1) || (menuPos == leftPageSize - 1 && leftCurrPage == leftTotalPage && _num == 1)) {
                    onMenuFocus();
                    return false;
                } else if ((menuPos == 0 && leftCurrPage > 1 && _num == -1) || (menuPos == leftPageSize - 1 && leftCurrPage < leftTotalPage && _num == 1)) {
                    leftCurrPage += _num;
                    menuPos = _num == -1 ? leftPageSize - 1 : 0;
                    initMenu();
                    return false;
                } else {
                    menuPos += _num;
                    menuPos = menuPos + (leftCurrPage - 1) * leftPageSize >= menuData.length ? (menuData.length - 1) % leftPageSize : menuPos;
                }
                listPos = 0;
                rightCurrPage = 1;

                ajaxContentList();
                console.log(1111)
            } else if (focusArea == 1) {
                if (contentData.length <= 0) {
                    return false;
                }
                loseContentFocus();
                if ((listPos == 0 && rightCurrPage == 1 && _num == -1) || (listPos == rightPageSize - 1 && rightCurrPage == rightTotalPage && _num == 1)) {;
                } else if ((listPos == 0 && rightCurrPage > 1 && _num == -1) || (listPos == rightPageSize - 1 && rightCurrPage < rightTotalPage && _num == 1)) {
                    rightCurrPage += _num;
                    listPos = _num == -1 ? rightPageSize - 1 : 0;
                    initContent();
                } else {
                    listPos += _num;
                    listPos = listPos + (rightCurrPage - 1) * rightPageSize >= contentData.length ? (contentData.length - 1) % rightPageSize : listPos;
                }
                onContentFocus();
            }
        }

        function changeLR(_num) {
            if (focusArea == 0) {
                if (contentData.length <= 0 || _num == -1) {
                    return false;
                }
                loseMenuFocus();
                focusArea = 1;
                onContentFocus();
            } else if (focusArea == 1) {
                if (contentData.length <= 0 || _num == 1) {
                    return false;
                }
                loseContentFocus();
                focusArea = 0;
                onMenuFocus();
            }
        }

        function doSelect() {
            if (focusArea == 1) {
                if (contentData.length <= 0) {
                    return false;
                }
                window.location.href = menuData[menuPos].enName + "/content.htm";
            }
        }
    </script>
</head>

<body style="background:url(images/bg4.jpg) no-repeat" topmargin="0" leftmargin="0" onload="init();">
    <!--标题-->
    <div style="position:absolute;left:330px;top:53px; width:24px; height:28px;"><img src="images/arrow_title00.png" width="35" height="34"></div>
    <div style="position:absolute;left:399px;top:47px; font-size:28px;color:#e81010; font-family:微软雅黑; font-weight:bold;">新闻中心</div>

    <!--左侧列表-->
    <div id="newsCenterLeft" style="position:absolute;left:58px;top:140px; width:201px; height:360px;display:block">
        <table border="0" cellpadding="0" cellspacing="0" width="100%" height="360" style="position:absolute;left:0px; font-size:26px; color:#000; text-align:center;">
            <tr height="66">
                <td id="menu_bg0" style="background:url(images/list_zfbg1.png)">政务要闻</td>
            </tr>
            <tr height="5">
                <td></td>
            </tr>
            <tr height="66">
                <td id="menu_bg1" style="background:url(images/list_zfbg1.png)">公示公告</td>
            </tr>
            <tr height="5">
                <td></td>
            </tr>
            <tr height="66">
                <td id="menu_bg2" style="background:url(images/list_zfbg1.png)">国务院</td>
            </tr>
            <tr height="5">
                <td></td>
            </tr>
            <tr height="66">
                <td id="menu_bg3" style="background:url(images/list_zfbg1.png)">部门动态</td>
            </tr>
            <tr height="5">
                <td></td>
            </tr>
            <tr height="66">
                <td id="menu_bg4" style="background:url(images/list_zfbg1.png)">今天关注</td>
            </tr>
        </table>
    </div>

    <!--列表-->
    <div id="newsCenterRight" style="position:absolute;left:267px;top:143px;width:952px;height:480px;">
        <img src="images/tab_zfbg5.png" width="952" height="488" />
        <div style="position:absolute;left:1px;top:0px;width:910px;height:435px;position:absolute;left:20px;font-size:24px; color:#000;">

            <div style="position:absolute;left:0px;top:0px;width:900px;height:54px; border-bottom:1px solid #a1c4de;">
                <div id="list_name0" style="position:absolute;left:25px;top:0px;width:726px;height:54px;line-height:54px;"></div>
                <div id="list_time0" style="position:absolute;left:755px;top:0px;width:162px;height:54px;text-align:center;color:#666; font-size:22px;line-height:54px;"></div>
            </div>

            <div style="position:absolute;left:0px;top:54px;width:900px;height:54px; border-bottom:1px solid #a1c4de;">
                <div id="list_name1" style="position:absolute;left:25px;top:0px;width:726px;height:54px;line-height:54px;"></div>
                <div id="list_time1" style="position:absolute;left:755px;top:0px;width:162px;height:54px;text-align:center;color:#666; font-size:22px;line-height:54px;"></div>
            </div>

            <div style="position:absolute;left:0px;top:108px;width:900px;height:54px; border-bottom:1px solid #a1c4de;">
                <div id="list_name2" style="position:absolute;left:25px;top:0px;width:726px;height:54px;line-height:54px;"></div>
                <div id="list_time2" style="position:absolute;left:755px;top:0px;width:162px;height:54px;text-align:center;color:#666; font-size:22px;line-height:54px;"></div>
            </div>

            <div style="position:absolute;left:0px;top:162px;width:900px;height:54px; border-bottom:1px solid #a1c4de;">
                <div id="list_name3" style="position:absolute;left:25px;top:0px;width:726px;height:54px;line-height:54px;"></div>
                <div id="list_time3" style="position:absolute;left:755px;top:0px;width:162px;height:54px;text-align:center;color:#666; font-size:22px;line-height:54px;"></div>
            </div>

            <div style="position:absolute;left:0px;top:216px;width:900px;height:54px; border-bottom:1px solid #a1c4de;">
                <div id="list_name4" style="position:absolute;left:25px;top:0px;width:726px;height:54px;line-height:54px;"></div>
                <div id="list_time4" style="position:absolute;left:755px;top:0px;width:162px;height:54px;text-align:center;color:#666; font-size:22px;line-height:54px;"></div>
            </div>

            <div style="position:absolute;left:0px;top:270px;width:900px;height:54px; border-bottom:1px solid #a1c4de;">
                <div id="list_name5" style="position:absolute;left:25px;top:0px;width:726px;height:54px;line-height:54px;"></div>
                <div id="list_time5" style="position:absolute;left:755px;top:0px;width:162px;height:54px;text-align:center;color:#666; font-size:22px;line-height:54px;"></div>
            </div>

            <div style="position:absolute;left:0px;top:325px;width:900px;height:54px; border-bottom:1px solid #a1c4de;">
                <div id="list_name6" style="position:absolute;left:25px;top:0px;width:726px;height:54px;line-height:54px;"></div>
                <div id="list_time6" style="position:absolute;left:755px;top:0px;width:162px;height:54px;text-align:center;color:#666; font-size:22px;line-height:54px;"></div>
            </div>

            <div style="position:absolute;left:0px;top:379px;width:900px;height:54px;border-bottom:1px solid #a1c4de;">
                <div id="list_name7" style="position:absolute;left:25px;top:0px;width:726px;height:54px;line-height:54px;"></div>
                <div id="list_time7" style="position:absolute;left:755px;top:0px;width:162px;height:54px;text-align:center;color:#666; font-size:22px;line-height:54px;"></div>
            </div>

            <div style="position:absolute;left:0px;top:433px;width:900px;height:54px;">
                <div id="list_name8" style="position:absolute;left:25px;top:0px;width:726px;height:54px;line-height:54px;"></div>
                <div id="list_time8" style="position:absolute;left:755px;top:0px;width:162px;height:54px;text-align:center;color:#666; font-size:22px;line-height:54px;"></div>
            </div>
        </div>
        <div id="newsCenterRightListFocus" style="position:absolute;left:-2px;top:-2px;display:none"><img src="images/list_zff3.png" width="922" height="58" /></div>
    </div>

    <!--滚动条-->
    <div id="listNewsCenterScroll" style="position:absolute;left:1200px;top:209px; width:8px; height:216px;">
        <div id="listNewsCenterScroll0" style="position:absolute;top:0px; width:8px; height:10px;"><img src="images/page0_1.png" width="8" height="10" /></div>
        <div id="listNewsCenterScroll1" style="position:absolute;top:17px; width:8px; height:106px; background:url(images/page0_2.png);"></div>
        <div id="listNewsCenterScroll2" style="position:absolute;top:116px; width:8px; height:10px;"><img src="images/page0_3.png" width="8" height="10" /></div>
    </div>

    <div id="listNewsCenterScrollFocus" style="position:absolute;left:1200px;top:209px; width:8px; height:216px;display:none;">
        <div id="listNewsCenterScrollFocus0" style="position:absolute;top:0px; width:8px; height:10px;"><img src="images/scrollFocus_01.png" width="8" height="10" /></div>
        <div id="listNewsCenterScrollFocus1" style="position:absolute;top:18px; width:8px; height:106px; background:url(images/scrollFocus_02.png);"></div>
        <div id="listNewsCenterScrollFocus2" style="position:absolute;top:116px; width:8px; height:10px;"><img src="images/scrollFocus_03.png" width="8" height="10" /></div>
    </div>

    <!--上下键-->
    <div id="currPage" style="position:absolute;left:856px;top:660px;width:30px;height:38px;line-height:38px;text-align:center;font-size:24px;color:#000000;">1</div>
    <div style="position:absolute;left:876px;top:660px;width:30px;height:38px;line-height:38px;text-align:center;font-size:24px;color:#000000;">/</div>
    <div id="totlePage" style="position:absolute;left:896px;top:660px;width:30px;height:38px;line-height:38px;text-align:center;font-size:24px;color:#000000;"></div>
    <div id="newsCenterPrePage" style="position:absolute;left:956px;top:660px;width:118px;height:38px;background:url(images/pageUd.png);line-height:38px;text-align:center;font-size:24px;color:#000000;">上一页</div>
    <div id="newsCenterNextPage" style="position:absolute;left:1086px;top:660px;width:118px;height:38px;background:url(images/pageUd.png);line-height:38px;text-align:center;font-size:24px;color:#000000;">下一页</div>
</body>


</html>