<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

  <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />

  <title>内容页--左图右文</title>

  <script type="text/javascript" src="js/common.js"></script>

  <script type="text/javascript">
    var dataAjaxPath = "content.js";

    var navTitleAjaxPath = "node.js";

    var cellPadValue = 10;

    var logoAjaxPath = "";

    var ajaxObj = null;

    var logoAjaxObj = null;

    var itemPos = 0;

    var imagePos = 0;

    var currPage = 0;

    var totalPage = 0;

    var pageContent = 430;

    var maxTitleSize = 15;

    var scrollBox = null;

    var menuData = [];

    var backUrl = "index.htm?itemPos=";



    document.onkeydown = eventHandler;



    function eventHandler(key) {

      var e = key || event;

      var keycode = e.keyCode || e.which || e.charCode;

      switch (keycode) {

        case 1: // up

        case 38:

          changeUD(-1);

          return false;

          break;

        case 2: // down

        case 40:

          changeUD(1);

          return false;

          break;

        case 3:

        case 37:

          changeLR(-1);

          break;

        case 4:

        case 39:

          changeLR(1);

          break;

        case 13:

          return false;

          break;

        case 339:
        case 27: //exit
          goPortal();

          event.returnValue = false;

          return false;

          break;

        case 8:

          goBack();

          event.returnValue = false;

          return false;

          break;

      }

    }



    function goBack() {

      window.location.href = backUrl + itemPos;

    }



    function changeUD(_num) {

      if (currPage == 0 && _num < 0 || currPage == totalPage - 1 && _num > 0) {

        return;

      } else {

        currPage = currPage + _num;

      }

      scrollBox.scroll(currPage);

      showScrollPage();

      $("content").style.top = -pageContent * currPage + "px";

    }





    function changeLR(_num) {

      if (menuData[itemPos].albumImages > 0) {

        imagePos = (imagePos + _num + menuData[itemPos].albumImages.length) % menuData[itemPos].albumImages.length;

        showImage();

      }

    }



    function init() {

      getParms();

      ajaxLoadMenuData();

      //ajaxLoadLogo();

      showTime();

    }



    function getParms() {

      var currLocation = window.location.href;

      var tempItemPos = getUrlParams("itemPos", window.location.href);

      if (tempItemPos != "") {

        itemPos = parseInt(tempItemPos, 10);

      }

      //iDebug(">>>getParms--itemPos="+itemPos);

    }





    function ajaxLoadMenuData() {

      if (ajaxObj != null) {

        ajaxObj.requestAbort();

      }

      ajaxObj = new AjaxClass();

      ajaxObj.frame = window;

      ajaxObj.charset = "gbk";

      ajaxObj.successCallback = function (_xmlHttp, _params) {

        ////iDebug(">>>ajaxLoadMenuData successCallback _xmlHttp.responseText=" + _xmlHttp.responseText);

        var jsonData = eval('(' + _xmlHttp.responseText + ')');

        if (typeof (jsonData) != "undefined" && jsonData.length > 0) {

          menuData = jsonData[itemPos];

          showImage();

          initTitle();

          initContent();

        } else {

          noItemData();

        }

        ajaxNavTitle();

      };

      ajaxObj.failureCallback = function (_xmlHttp, _params) {

        //iDebug(">>>ajaxLoadMenuData failureCallback");

        noItemData();

        ajaxNavTitle();

      };

      ajaxObj.url = dataAjaxPath;

      //iDebug(">>>ajaxLoadMenuData ajaxObj.url=" + ajaxObj.url);

      ajaxObj.requestData();

    }



    function ajaxNavTitle() {

      ajaxObj = null;

      if (ajaxObj != null) {

        ajaxObj.requestAbort();

      }

      ajaxObj = new AjaxClass();

      ajaxObj.frame = window;

      ajaxObj.charset = "gbk";

      ajaxObj.successCallback = function (_xmlHttp, _params) {

        //iDebug(">>>ajaxLoadMenuData successCallback _xmlHttp.responseText=" + _xmlHttp.responseText);

        var jsonData = eval('(' + _xmlHttp.responseText + ')');

        if (typeof (jsonData) != "undefined") {

          if (jsonData.navigator != "") {

            $("navTitle").innerText = jsonData.navigator;

            $("navTitle").style.left = (235 + ($("logoImage").width) + cellPadValue) + "px";

          }

        } else {}

      };

      ajaxObj.failureCallback = function (_xmlHttp, _params) {};

      ajaxObj.url = navTitleAjaxPath;

      ajaxObj.requestData();

    }



    function noItemData() {

      $("leftArrow").style.visibility = "hidden";

      $("rightArrow").style.visibility = "hidden";

      $("poster").src = "images/global_tm.gif";

      $("content").innerText = "暂无数据";

      noScrollBar();

    }



    function initTitle() {

      $("title").innerHTML = menuData.title;

      if (getStrChineseLength(menuData.title) > maxTitleSize) {

        $("title").innerHTML = "<marquee style=\"width:380px;\">" + menuData.title + "</marquee>";

      }

    }



    function showImage() {

      var images = menuData.albumImages;

      if (images.length > 0) {

        $("poster").src = images[imagePos].imageUrl;

      }

    }



    function initContent() {

      if (menuData.content == "") {

        $("content").innerHTML = "暂无相关介绍";

      } else {

        $("content").innerHTML = menuData.content;

      }

      $("content").style.top = -pageContent * currPage + "px";

      totalPage = Math.floor($("content").offsetHeight / pageContent) + 1;

      initScroll();

    }



    function initScroll() {

      scrollBox = null;

      if (totalPage > 1) {

        $("barDiv").style.visibility = "visible";

        scrollBox = new ScrollBar("barDiv", "barDiv", window);

        scrollBox.init(totalPage, totalPage, 424, 0, 61);

        scrollBox.scroll(currPage);

        showScrollPage();

      } else {

        noScrollBar();

      }

    }





    function noScrollBar() {

      $("barDiv").style.visibility = "hidden";

      $("currPage").innerText = 0;

      $("totalPage").innerText = 0;

      scrollBox = null;

    }



    function showScrollPage() {

      if (totalPage > 1) {

        $("currPage").innerText = currPage + 1;

        $("totalPage").innerText = totalPage;

      }

    }



    function ajaxLoadLogo() {

      if (logoAjaxObj != null) {

        logoAjaxObj.requestAbort();

      }

      logoAjaxObj = new AjaxClass();

      logoAjaxObj.frame = window;

      logoAjaxObj.charset = "gbk";

      logoAjaxObj.successCallback = function (_xmlHttp, _params) {

        ////iDebug(">>>ajaxLogoData successCallback _xmlHttp.responseText=" + _xmlHttp.responseText);

        var jsonData = eval('(' + _xmlHttp.responseText + ')');

        if (typeof (jsonData) != "undefined" && jsonData.length > 0) {

          if (typeof jsonData[0].logoImageUrl != "undefined" && jsonData[0].logoImageUrl != "") {

            $("logoImage").src = jsonData[0].logoImageUrl;

          } else {

            $("logoImage").src = "images/global_tm.gif";

          }

        } else {

          $("logoImage").src = "images/global_tm.gif";

        }

      };

      logoAjaxObj.failureCallback = function (_xmlHttp, _params) {

        ////iDebug(">>>ajaxLogoData failureCallback");

        $("logoImage").src = "images/global_tm.gif";

      };

      logoAjaxObj.url = logoAjaxPath;

      ////iDebug(">>>ajaxLogoData logoAjaxObj.url=" + logoAjaxObj.url);

      logoAjaxObj.requestData();

    }



    function showTime() {

      var currTime = formatTime("yyyy-MM-dd hh:mm", new Date());

      $("time").innerText = currTime;

      setTimeout("showTime()", 1000);

    }
  </script>



</head>



<body background="images/nr_bg.jpg" leftmargin="0" topmargin="0" onload="init()">



  <div style="position: absolute; left: 230px; top: 32px;"><img id="logoImage" src="images/logo.png" /></div>



  <div style="position: absolute; left: 924px; top: 41px; width: 291px; height: 35px; font-size: 24px; text-align: right;"
    id="time"></div>

  <!--logo、标题-->

  <div style="position: absolute; left: 367px; width: 844px; height: 49px; top: 32px; line-height: 49px; font-size: 27px" id="navTitle"></div>



  <!--分割线-->

  <div style="position: absolute; left: 760px; top: 184px; width: 425px; height: 3px; background: url(images/line.png);"></div>



  <!---->

  <div style="position: absolute; left: 34px; top: 90px; width: 701px; height: 540px;">

    <!--标题-->

    <div style="position: absolute; left: 706px; top: 24px; width: 460px; height: 489px; font-size: 24px; color: #000000; line-height: 57px; text-align: center; background: url(images/btm_bg0.png) no-repeat left top;">

    </div>



    <div id="title" style="position: absolute; left: 726px; top: 39px; width: 427px; height: 53px; font-size: 30px; color: #000000; line-height: 57px; text-align: center; border-bottom: 1px; font-weight: 600">

    </div>



    <!--内容-->

    <div style="position: absolute; left: 716px; top: 103px; width: 440px; height: 393px; font-size: 24px; color: #000000; line-height: 48px; overflow: hidden;">

      <div id="content" style="position: absolute; left: 11px; top: 0px; width: 420px;"></div>

    </div>



    <!--页码-->

    <div style="position: absolute; left: 1169px; top: 89px; width: 4px; height: 424px; background-color: #828282;">

      <div style="position:absolute; left:-12px; top:40px; width:29px; height:61px; background-image: url(images/page.png); visibility:hidden"
        id="barDiv">

        <div style="position:absolute; left:0px; top:0px; width:29px; height:29px; font-size:24px; color:#ffffff; text-align:center;"
          id="currPage"></div>

        <div style="position:absolute; left:0px; top:31px; width:29px; height:29px; font-size:24px; color:#ffffff; text-align:center;"
          id="totalPage"></div>

      </div>

    </div>



  </div>

  <!--海报-->

  <div style="position: absolute; left: 69px; top: 164px; width: 666px; height: 426px;"><img id="poster" src="" width="656" height="424" /></div>





  <!---滚动字幕-->

  <!--<div style="position: absolute; left: 112px; top: 651px; width: 700px; height: 30px; font-size: 22px; line-height: 30px; overflow: hidden;">

  <div style="position:absolute; left:0px; top:0px; height:30px;width:463px;;font-size:22px;line-height:30px;color:#000000; width: 727px;-webkit-transition-duration:500ms;" align="left" id="marquee_ad0"></div>

  <div style="position:absolute; left:0px; top:-30px; height:30px;width:463px;;font-size:22px;line-height:30px;color:#000000; width: 727px;-webkit-transition-duration:500ms;" align="left" id="marquee_ad1"></div>

</div>-->

  <div style="position: absolute; width: 27px; height: 31px; left: 69px; top: 359px;" id="leftArrow"><img src="images/left1.png" width="21" height="23" /></div>

  <div style="position: absolute; width: 23px; height: 34px; left: 703px; top: 349px;" id="rightArrow"><img src="images/right1.png" width="21" height="23" /></div>

  <div style="position: absolute; width: 544px; height: 30px; left: 112px; top: 593px; font-size: 24px; color: #333; font-weight: 600">温馨提示：按左右键切换图片，上下键滑动文字</div>

</body>

</html>