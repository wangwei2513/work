<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

  <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />

  <title>list---iframe</title>

  <style type="text/css">
    .mf {
      position: absolute;
      left: 0px;
      top: 110px;
      width: 244px;
      height: 63px;
      background: url(images/mf01.png) no-repeat;
      text-align: center;
      padding-top: 15px;
      color: #a08e7c;
      line-height: 50px;
      font-size: 30px;
      font-weight: bold;
    }
  </style>

  <script type="text/javascript" src="js/common.js"></script>

  <script type="text/javascript">
    var dataAjaxPath = "menu.js";

    var navTitleAjaxPath = "node.js";

    var cellPadValue = 10;

    var logoAjaxPath = "";

    var columnBox = null;

    var ajaxObj = null;

    var logoAjaxObj = null;

    var columnMaxSize = 7;

    var columnLen = 7;

    var focusArea = 0;

    var mainMenuPos = 0;

    var itemPos = 0;

    var iframeLoadFinish = false;

    var filePath = "";

    var changePageTimeout = -1;



    var havaBackUrl = false;

    var backUrl = "../index.htm";



    document.onkeydown = eventHandler;

    function eventHandler(key) {

      var e = key || event;

      var keycode = e.keyCode || e.which || e.charCode;

      if (focusArea == 1) {

        window.parent.frames["listFrame"].eventHandler(keycode);

        return false;

      }

      switch (keycode) {

        case 1: // up

        case 38:

          changeUD(-1);

          return false;

          break;

        case 2: // down

        case 40:

          changeUD(1);

          return false;

          break;

        case 3: // left

        case 37:



          return false;

          break;

        case 4: // right

        case 39:

          changeLR(1);

          return false;

          break;

        case 13:

          return false;

          break;

        case 8:

          goBack();

          event.returnValue = false;

          return false;

          break;

        case 339:
        case 27: //exit
          goPortal();

          event.returnValue = false;

          return false;

          break;

      }

    }





    function goBack() {

      if (havaBackUrl) {

        window.location.href = backUrl;

      } else {

        goPortal();

      }

    }







    function changeLR(_num) {

      if (columnBox != null && _num > 0 && iframeLoadFinish && window.parent.frames['listFrame'].itemBox != null) {

        clearFocus();

        focusArea = 1;

        window.parent.frames['listFrame'].showFocus();

        showFocus();

      }

    }





    function changeUD(_num) {

      if (columnBox != null) {

        clearFocus();

        columnBox.changeList(_num);

        itemPos = 0;

        includeIframe();

        showFocus();

      }

    }



    function init() {

      getParms();

      ajaxLoadMenuData();

      //ajaxLoadLogo();

      showTime();

    }











    function getParms() {

      var currLocation = window.location.href;

      var tempMainMenuPos = getUrlParams("mainMenuPos", currLocation);

      if (tempMainMenuPos != "") {

        mainMenuPos = parseInt(tempMainMenuPos, 10);

      }



      var tempItemPos = getUrlParams("itemPos", currLocation);

      if (tempItemPos != "") {

        itemPos = parseInt(tempItemPos, 10);

      }



      var tempArea = getUrlParams("focusArea", currLocation);

      if (tempArea != "") {

        focusArea = parseInt(tempArea, 10);

      }

      //iDebug("list.htm--focusArea="+focusArea+"|mainMenuPos="+mainMenuPos);

    }





    function ajaxNavTitle() {

      ajaxObj = null;

      if (ajaxObj != null) {

        ajaxObj.requestAbort();

      }

      ajaxObj = new AjaxClass();

      ajaxObj.frame = window;

      ajaxObj.charset = "gbk";

      ajaxObj.successCallback = function (_xmlHttp, _params) {

        //iDebug(">>>ajaxLoadMenuData successCallback _xmlHttp.responseText=" + _xmlHttp.responseText);

        var jsonData = eval('(' + _xmlHttp.responseText + ')');

        if (typeof (jsonData) != "undefined") {

          if (jsonData.name != "") {

            $("name").innerText = jsonData.name;

            $("name").style.left = (235 + ($("logoImage").width) + cellPadValue) + "px";

          }

        } else {}

      };

      ajaxObj.failureCallback = function (_xmlHttp, _params) {};

      ajaxObj.url = navTitleAjaxPath;

      ajaxObj.requestData();

    }



    function ajaxLoadMenuData() {

      ajaxObj = null;

      if (ajaxObj != null) {

        ajaxObj.requestAbort();

      }

      ajaxObj = new AjaxClass();

      ajaxObj.frame = window;

      ajaxObj.charset = "gbk";

      ajaxObj.successCallback = function (_xmlHttp, _params) {

        ////iDebug(">>>ajaxLoadMenuData successCallback _xmlHttp.responseText=" + _xmlHttp.responseText);

        var jsonData = eval('(' + _xmlHttp.responseText + ')');

        if (typeof (jsonData) != "undefined" && jsonData.length > 0) {

          menuData = jsonData;

          showItem();

        } else {

          noItemData();

        }

        checkBackUrl();

        ajaxNavTitle();

      };

      ajaxObj.failureCallback = function (_xmlHttp, _params) {

        //iDebug(">>>ajaxLoadMenuData failureCallback");

        noItemData();

        checkBackUrl();

        ajaxNavTitle();

      };

      ajaxObj.url = dataAjaxPath;

      //iDebug(">>>ajaxLoadMenuData ajaxObj.url=" + ajaxObj.url);

      ajaxObj.requestData();

    }



    function showItem() {

      columnBox = new showList(columnLen, menuData.length, mainMenuPos, 0, window);

      columnBox.focusDiv = "focus";

      columnBox.haveData = function (_list) {

        $("column" + _list.idPos).style.visibility = "visible";

        $("column" + _list.idPos).innerHTML = subStr(menuData[_list.dataPos].name, columnMaxSize, "...");

      };

      columnBox.notData = function (_list) {

        $("column" + _list.idPos).style.visibility = "hidden";

        $("column" + _list.idPos).innerHTML = "";

      };

      columnBox.startShow();

      includeIframe();

      clearFocus();

      showFocus();

    }



    function noItemData() {

      for (var i = 0; i < columnLen; i++) {

        $("column" + i).style.visibility = "hidden";

      }

    }





    function includeIframe() {

      filePath = menuData[columnBox.position].enName;

      clearTimeout(changePageTimeout);

      changePageTimeout = setTimeout(function () {

        $("listFrame").src = filePath + "/index.htm?random=" + Math.random();

        iframeLoadFinish = true;

      }, 300);

    }





    function clearFocus() {

      if (focusArea == 0) {

        $("column" + columnBox.focusPos).style.backgroundImage = "url(images/mf01.png)";

        $("column" + columnBox.focusPos).style.color = "";

        $("column" + columnBox.focusPos).innerHTML = subStr(menuData[columnBox.position].name, columnMaxSize, "...");

      } else if (focusArea == 1) {



      }

    }



    function showFocus() {

      if (focusArea == 0) {

        $("column" + columnBox.focusPos).style.backgroundImage = "url(images/mf02.png)";

        $("column" + columnBox.focusPos).style.color = "#ffffff";

        if (getStrChineseLength(menuData[columnBox.position].name) > columnMaxSize) {

          $("column" + columnBox.focusPos).innerHTML = "<marquee width=180>" + menuData[columnBox.position].name +
            "</marquee>";

        }

      } else if (focusArea == 1) {

        $("column" + columnBox.focusPos).style.backgroundImage = "url(images/mf01.png)";

        $("column" + columnBox.focusPos).style.color = "#e28a0d";

      }

    }





    function checkBackUrl() {

      ajaxObj = null;

      ////iDebug(">>>zhaoql--checkBackUrl--ajaxObj="+ajaxObj);

      if (ajaxObj != null) {

        ajaxObj.requestAbort();

      }

      ajaxObj = new AjaxClass();

      ajaxObj.frame = window;

      ajaxObj.charset = "gbk";

      ajaxObj.successCallback = function (_xmlHttp, _params) {

        ////iDebug(">>>zhaoql--checkBackUrl--successCallback。。。。。");

        havaBackUrl = true;

      };

      ajaxObj.failureCallback = function (_xmlHttp, _params) {

        ////iDebug(">>>zhaoql--checkBackUrl--failureCallback。。。。。");

        havaBackUrl = false;

      };

      ajaxObj.url = backUrl;

      ajaxObj.requestData();

    }



    function ajaxLoadLogo() {

      if (logoAjaxObj != null) {

        logoAjaxObj.requestAbort();

      }

      logoAjaxObj = new AjaxClass();

      logoAjaxObj.frame = window;

      logoAjaxObj.charset = "gbk";

      logoAjaxObj.successCallback = function (_xmlHttp, _params) {

        ////iDebug(">>>ajaxLogoData successCallback _xmlHttp.responseText=" + _xmlHttp.responseText);

        var jsonData = eval('(' + _xmlHttp.responseText + ')');

        if (typeof (jsonData) != "undefined" && jsonData.length > 0) {

          if (typeof jsonData[0].logoImageUrl != "undefined" && jsonData[0].logoImageUrl != "") {

            $("logoImage").src = jsonData[0].logoImageUrl;

          } else {

            $("logoImage").src = "images/global_tm.gif";

          }

        } else {

          $("logoImage").src = "images/global_tm.gif";

        }

      };

      logoAjaxObj.failureCallback = function (_xmlHttp, _params) {

        ////iDebug(">>>ajaxLogoData failureCallback");

        $("logoImage").src = "images/global_tm.gif";

      };

      logoAjaxObj.url = logoAjaxPath;

      ////iDebug(">>>ajaxLogoData logoAjaxObj.url=" + logoAjaxObj.url);

      logoAjaxObj.requestData();

    }



    function showTime() {

      var currTime = formatTime("yyyy-MM-dd hh:mm", new Date());

      $("time").innerText = currTime;

      setTimeout("showTime()", 1000);

    }
  </script>

</head>



<body background="images/tm_bg.jpg" leftmargin="0" topmargin="0" onload="init();">



  <div style="position: absolute; left: 230px;  top: 32px;"><img id="logoImage" src="images/logo.png" /></div>

  <div style="position: absolute; left: 367px; width: 844px; height: 49px; top: 32px; line-height: 49px; font-size: 27px" id="name"></div>

  <div style="position: absolute; left: 744px; top: 41px; width: 466px; height: 35px; font-size: 24px; text-align: right;"
    id="time"></div>



  <div style="position:absolute; left:58px; top:100px; width:245px; height:527px; ">

    <div class="mf" style="top:0px;" id="column0">&nbsp;</div>

    <div class="mf" style="top:75px;" id="column1">&nbsp;</div>

    <div class="mf" style="top:150px;" id="column2">&nbsp;</div>

    <div class="mf" style="top:225px;" id="column3">&nbsp;</div>

    <div class="mf" style="top:300px;" id="column4">&nbsp;</div>

    <div class="mf" style="top:375px;" id="column5">&nbsp;</div>

    <div class="mf" style="top:450px;" id="column6">&nbsp;</div>

  </div>





  <!--fake focus-->

  <div style="position:absolute;" id="focus"></div>



  <!--<div style="position:absolute; left:327px; top:107px; width:835px; height:513px; ">

  <div style="position:absolute; left:-12px; top:122px; width:849px; height:64px; background-color: #e28a0d; layer-background-color: #e28a0d; border: 1px none #000000;"></div>

  <div style="position:absolute; left:19px; top:-8px; width:797px; height:61px;">

    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="font-size:26px; line-height:65px; color:#3f3f3f;">

      <tr>

        <td id="item0">&nbsp;</td>

        <td id="date0">&nbsp;</td>

      </tr>

      <tr>

        <td id="item1">&nbsp;</td>

        <td id="date1">&nbsp;</td>

      </tr>

      <tr style="color:#ffffff;">

        <td id="item2">&nbsp;</td>

        <td id="date2">&nbsp;</td>

      </tr>

      <tr>

        <td id="item3">臓単&nbsp; </td>

        <td id="date3">&nbsp;</td>

      </tr>

      <tr>

        <td id="item4">&nbsp; </td>

        <td id="date4">&nbsp;</td>

      </tr>

      <tr>

        <td id="item5">&nbsp;</td>

        <td id="date5">&nbsp;</td>

      </tr>

      <tr>

        <td id="item6">&nbsp;</td>

        <td id="date6">&nbsp;</td>

      </tr>

      <tr>

        <td id="item7">&nbsp;</td>

        <td id="date7">&nbsp;</td>

      </tr>

    </table>

  </div>

</div>





<div style="position:absolute; left:1189px; top:118px; width:3px; height:492px; background-color: #828282;">

  <div style="position:absolute; left:-12px; top:40px; width:29px; height:61px; background-image: url(images/page.png); ">

    <div style="position:absolute; left:0px; top:0px; width:29px; height:29px; font-size:24px; color:#ffffff; text-align:center;">1</div>

    <div style="position:absolute; left:0px; top:31px; width:29px; height:29px; font-size:24px; color:#ffffff; text-align:center;">14</div>

  </div>

</div>

-->

  <div style="position:absolute; left:106px; top:655px; width:1059px; height:24px; color:#6d6d6d; font-size:22px; ">

    <marquee dir="ltr" id="marqueeContent">

    </marquee>

  </div>





  <div style="position:absolute; width:910px; height:522px; left: 313px; top: 99px; z-index:2">

    <iframe id="listFrame" name="listFrame" src="" frameborder="0" scrolling="no" style="width: 910px; height: 522px;"></iframe>

  </div>



</body>

</html>