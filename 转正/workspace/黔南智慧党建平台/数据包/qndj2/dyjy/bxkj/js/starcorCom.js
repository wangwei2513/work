!function(win){function obj2querystr(e){var t="";if("object"==typeof e)for(var _ in e)e.hasOwnProperty(_)&&(t+=""==t?_+"="+e[_]:"&"+_+"="+e[_]);else t=e;return t}function jsonToString(e){switch(typeof e){case"string":return'"'+e.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+e.map(this.jsonToString).join(",")+"]";case"object":if(e instanceof Array){for(var t=[],_=e.length,a=0;a<_;a++)t.push(this.jsonToString(e[a]));return"["+t.join(",")+"]"}if(null==e)return"null";var s=[];for(var n in e)s.push(this.jsonToString(n)+":"+this.jsonToString(e[n]));return"{"+s.join(",")+"}";case"number":return e;case"boolean":return e;case"undefined":return"null"}}function ajax_obj(e,t){this.xhr=null,this.timeoutID=-1,this.tryReqNum=e||0===e?e:RETRY_NUM,this.out_time=t||0===t?t:RETRY_TIME,this.reqType="GET",this.success=null,this.error=null,this.requestUrl="",this.requestParam=null,this.req_datatype="JSON",this.is_cancel=!1,this._is_working=!1,this.xhr=new XMLHttpRequest}function implement_que(){if(req_wait_que.length>0){var e=req_wait_que.shift(),t=e.params.req_type||"GET";delete e.params.req_type,this.set_request(e.url,e.params,e.success,t,e.error,e.datatype)}}function combination_params(e,t){e&&"object"==typeof e||(e=t);for(var _ in t)t.hasOwnProperty(_)&&!e[_]&&(e[_]=t[_])}var MAX_REQ_NUM=3,RETRY_NUM=3,RETRY_TIME=1e4,last_ajax_idx=0,req_wait_que=[],login_info={nns_user_agent:"nn_player/std",nns_output_type:"json"};ajax_obj.prototype.set_request=function(e,t,_,a,s,n){if(a?this.reqType=a:this.reqType="GET",n?this.req_datatype=n:this.req_datatype="JSON",this._is_working=!0,this.success=_,this.error=s,"JSONP"===this.req_datatype){var r=e;t.nns_output_type="jsonp",t.nns_func?this.jsonp_func_name="jsonp_"+t.nns_func:this.jsonp_func_name="flightHandler",t.nns_jsonp_func=this.jsonp_func_name,r+=r.indexOf("?")!==-1?"&"+obj2querystr(t):"?"+obj2querystr(t),r=cdnRule.get_url(r),r=encodeURI(r.replace(/\?\&/,"?")),this.send_jsonp_request(r)}else if("GET"==this.reqType){var r=e;r+=r.indexOf("?")!==-1?"&"+obj2querystr(t):"?"+obj2querystr(t),r=cdnRule.get_url(r),r=encodeURI(r.replace(/\?\&/,"?")),this.sendRequestGet(r)}else{var i=this.obj2querystr(t);this.sendRequestPost(e,i)}},ajax_obj.prototype.createXMLHttpRequest=function(){try{this.xhr=new XMLHttpRequest}catch(e){}},ajax_obj.prototype.sendRequestGet=function(e){var t=this;this.requestUrl=e,clearTimeout(this.timeoutID),this.tryReqNum--,this.timeoutID=setTimeout(function(){clearTimeout(t.timeoutID),t.xhr.abort(),t.tryReqNum>0?t.sendRequestGet(e):t.implement_call({header:1e4,reason:"request timeout, please check network"})},this.out_time),this.xhr.open("GET",e,!0),this.xhr.onreadystatechange=function(){t.processResponse()},this.xhr.send(null)},ajax_obj.prototype.sendRequestPost=function(e,t){var _=this;this.requestUrl=e,this.requestParam=t,clearTimeout(this.timeoutID),this.tryReqNum--,this.timeoutID=setTimeout(function(){clearTimeout(_.timeoutID),_.xhr.abort(),_.tryReqNum>0?_.sendRequestPost(e,t):_.implement_call({header:1e4,reason:"request timeout, please check network"})},this.out_time),this.xhr.open("POST",e,!0),this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xhr.onreadystatechange=function(){_.processResponse()},this.xhr.send(t)},ajax_obj.prototype.send_jsonp_request=function(e){var t=this;this.requestUrl=e,clearTimeout(this.timeoutID),this.tryReqNum--,this.timeoutID=setTimeout(function(){clearTimeout(t.timeoutID),document.getElementsByTagName("head")[0].removeChild(t.script_ele),t.tryReqNum>0?t.send_jsonp_request(e):"function"==typeof this.error&&t.error({header:1e4})},this.out_time),window[this.jsonp_func_name]=function(e){t.js_load_complete(e)};var _=document.createElement("script");_.type="text/javascript",_.src=this.requestUrl,document.getElementsByTagName("head")[0].appendChild(_),this.script_ele=_},ajax_obj.prototype.js_load_complete=function(e){clearTimeout(this.timeoutID);try{"function"!=typeof this.success||this.is_cancel||(e.header=200,this.success(e))}catch(e){}this.tryReqNum=RETRY_NUM,document.getElementsByTagName("head")[0].removeChild(this.script_ele),this._is_working=!1,implement_que.call(this)},ajax_obj.prototype.cancel_ajax=function(){this.is_cancel=!0,this._is_working=!1,this.tryReqNum=RETRY_NUM,"JSONP"===this.datatype?document.head.removeChild(this.script_ele):this.xhr.abort(),clearTimeout(this.timeoutID)},ajax_obj.prototype.processResponse=function(){if(4==this.xhr.readyState)if(200==this.xhr.status){if(this.is_cancel)return null;clearTimeout(this.timeoutID);var response_txt=this.xhr.responseText,resp={};if(""!=response_txt)try{resp=eval("("+response_txt+")"),resp.header=200}catch(e){resp.header=10001,resp.reason="json formart error, data is not json string",resp.response_txt=response_txt}else resp={header:this.xhr.status,reason:"response data string is ''"};this.implement_call(resp),resp=null}else if(0==this.tryReqNum&&0!=this.xhr.status){clearTimeout(this.timeoutID);var resp={header:this.xhr.status,reason:"request data error, request status is "+this.xhr.status};this.implement_call(resp)}},ajax_obj.prototype.implement_call=function(e){"function"==typeof this.success&&200===e.header?this.success(e):"function"==typeof this.error&&200!==e.header&&this.error(e),this.xhr.abort(),this._is_working=!1,clearTimeout(this.timeoutID),this.tryReqNum=RETRY_NUM,this.reqType="GET",this.callBack=null,this.requestUrl="",this.requestParam=null,implement_que.call(this)};var nw_ajax={urls:{}};nw_ajax.init=function(){for(var e=1;e<=MAX_REQ_NUM;e++)this["_ajax_req_"+e]=new ajax_obj},nw_ajax.get_data=function(e,t,_,a,s){var n=e;if("string"!=typeof e)return this;if(e.indexOf("/")===-1&&(n=this.get_url_by_no(e),!n))return console.error("interface not validã€‚"),this;combination_params(t,login_info);for(var r=null,i=1;i<=MAX_REQ_NUM;i++){var o=i+last_ajax_idx>MAX_REQ_NUM?i-MAX_REQ_NUM+last_ajax_idx:i+last_ajax_idx;if(!this["_ajax_req_"+o]._is_working){r=this["_ajax_req_"+o],last_ajax_idx=o;break}}var c="function"==typeof a?a:null,u=s?s:"string"==typeof a?a:"JSONP";if(!r)return req_wait_que.push({url:n,params:t,success:_,error:c,datatype:u}),this;var l=t.req_type||"GET";return delete t.req_type,r.set_request(n,t,_,l,c,u),delete l,r=null,this},nw_ajax.set_common_data=function(e,t){return login_info[e]=t,this},nw_ajax.get_url_by_no=function(e){return e=e.toUpperCase(),this.urls[e]},nw_ajax.get_base_data=function(e,t,_){var a=e||"http://cs.interface.cloudepg.net/vds/STBindex";return this.get_data(a,{},function(e){t(e)},_),this},nw_ajax.get_epg_base_data=function(e,t){var _=this,a=this.urls.N3_A_2;return this.get_data(a,{},function(t){for(var a in t.n3_a){var s=a.toUpperCase();_.urls[s]=t.n3_a[a].url}e()},t),this},nw_ajax.init(),win.nw_ajax_v2=nw_ajax}(window),function(e){var t={N2_A:"ClientIndex",N3_A_D:"MAPindex",N24_A:"SpecialIndex",N36_A:"MetaDataIndex",N39_A:"EPGV2",N40_A:"UserIndex",N40_B:"UserMessageBoard",N40_C:"UserScoreIndex",N40_D:"UserRecommendIndex",N40_E:"UserMessageIndex",N40_F:"UserIntelEpg",N40_G:"UserVideoWish",N40_J:"GetVideoComments",N40_I:"UserBackPlayReserve",N50_A:"AuthIndex",N51_A:"AuthIndexStandard",N215_A:"AAAAuth"},_={N1_A_1:"STBindex",N2_A_3:"ClientIndex/sync_time",N24_A_1:"SpecialIndex/get_special_info",N24_A_2:"SpecialIndex/get_special_item_list",N24_A_3:"SpecialIndex/search_special_item",N24_A_4:"SpecialIndex/get_special_online",N24_A_5:"SpecialIndex/get_special_info_by_ids",N3_A_D_7:"MetaDataIndex/get_media_assets_item_by_labels",N36_A_1:"MetaDataIndex/get_init_meta_data",N36_A_2:"MetaDataIndex/get_skin",N36_A_3:"MetaDataIndex/get_public_image",N36_A_4:"MetaDataIndex/get_public_image_v2",N36_A_5:"MetaDataIndex/get_terminal_realtime_params",N36_A_6:"MetaDataIndex/get_live_templates",N36_A_7:"MetaDataIndex/get_templates_by_assists",N39_A_1:"EPGV2/get_channel_list",N39_A_2:"EPGV2/get_media_asset_by_video_id",N39_A_3:"EPGV2/get_chats_list",N39_A_4:"EPGV2/get_actor_star_list",N39_A_5:"EPGV2/get_actor_star_info",N39_A_6:"EPGV2/get_dy_data_by_video_id",N39_A_7:"EPGV2/get_total_media_asset_item_list",N39_A_8:"EPGV2/transformat_keys",N39_A_9:"EPGV2/get_index_list_by_category",N39_A_10:"EPGV2/get_dy_data_by_index_id",N39_A_11:"EPGV2/search_video_index_list",N39_A_12:"EPGV2/get_playbill_by_days",N39_A_13:"EPGV2/get_agreement_list",N39_A_14:"EPGV2/search_actor_star_list",N39_A_15:"EPGV2/get_media_asset_list_v2",N39_A_16:"EPGV2/get_actor_star_screening_range",N39_A_17:"EPGV2/get_hot_actor_star_list",N39_A_18:"EPGV2/get_current_playbill",N39_A_19:"EPGV2/get_channel_by_buss",N39_A_20:"EPGV2/get_video_info_list",N39_A_21:"EPGV2/get_preview_list_by_video_id",N39_A_22:"EPGV2/get_item_list_by_assist_id",N39_A_23:"EPGV2/get_media_assets_bind_labels_v2",N39_A_24:"EPGV2/get_video_info_v3",N39_A_25:"EPGV2/get_media_assets_info_v2",N39_A_26:"EPGV2/get_dynamic_category_item_list",N39_A_29:"EPGV2/get_playbill_by_ad_device",N39_A_30:"EPGV2/get_video_index_list",N39_A_31:"EPGV2/search_media_assets_item_v2",N39_A_32:"EPGV2/get_video_recom_video",N39_A_33:"EPGV2/get_video_play_after_info",N39_A_34:"EPGV2/get_playbill_by_days_v2",N39_A_35:"EPGV2/get_player_exit_data",N39_A_36:"EPGV2/get_search_hot_word_list",N39_A_37:"EPGV2/get_media_by_original_id",N39_A_38:"EPGV2/search_playbill",N39_A_39:"EPGV2/get_playbill_recommend_list",N39_A_40:"EPGV2/get_assets_info_by_product_id",N40_A_1:"UserIndex/get_collect_list_v2",N40_A_2:"UserIndex/add_collect_v2",N40_A_3:"UserIndex/delete_collect_v2",N40_A_4:"UserIndex/get_playlist_v2",N40_A_5:"UserIndex/add_playlist_v2",N40_A_6:"UserIndex/delete_playlist_v2",N40_A_7:"UserIndex/get_catch_list_v2",N40_A_8:"UserIndex/add_catch_v2",N40_A_9:"UserIndex/delete_catch_v2",N40_A_10:"UserIndex/sync_collect_by_user",N40_A_11:"UserIndex/sync_playlist_by_user",N40_A_12:"UserIndex/sync_catch_by_user",N40_D_1:"UserRecommendIndex/get_user_recommend",N40_D_2:"UserRecommendIndex/set_user_recommend",N40_D_3:"UserRecommendIndex/get_user_recommend_v2",N40_D_4:"UserRecommendIndex/get_own_calc_user_recommend",N40_I_1:"UserBackPlayReserve/add_channel_subscribe",N40_I_2:"UserBackPlayReserve/cancel_channel_subscribe",N50_A_1:"AuthIndex/auth_play",N50_A_2:"AuthIndex/apply_play",N50_A_3:"AuthIndex/apply_download",N215_A_1:"AAAAuth/scaaa_device_auth",N215_A_4:"AAAAuth/scaaa_auth_token"},a=function(e){var t={},_={},a=e.split("?");if(a[1]){var s=a[1].split("&");for(var n in s)if("string"==typeof s[n]){var r=s[n].split("=");_[r[0]]=r[1]}}return t.baseUrl=a[0],t.params=_,t},s={cdns:{},cdnexcept:["UserId","Token","MacId","SmartCardId","DeviceId","UserPassword","Webtoken","ExData","NetId"],rule:{},api_host:{},errcodeRule:{N1_A_1:"1002006",N3_A_2:"1002006",N3_A_A_3:"1002008",N3_A_A_4:"1002005",N3_A_A_5:"1002010",N3_A_A_6:"1002005",N3_A_A_7:"1002011",N3_A_A_8:"1002007",N3_A_A_9:"1002012",N3_A_A_10:"1002005",N3_A_A_12:"1002008",N3_A_A_13:"1002008",N3_A_A_14:"1002008",N3_A_A_15:"1002005",N3_A_D_1:"1002007",N3_A_D_2:"1002007",N3_A_D_4:"1002005",N3_A_D_5:"1002005",N3_A_D_6:"1002012",N3_A_D_7:"1002007",N3_A_D_8:"1002013",N3_A_D_9:"1002013",N3_A_D_10:"1002007",N3_A_D_11:"1002007",N3_A_G_1:"1002007",N3_A_G_2:"1002007",N3_A_G_3:"1002007",N3_A_G_4:"1002007",N3_A_G_5:"1002007",N3_A_H_1:"1002007",N100_A_1:"1002005",N100_A_2:"1002005",N100_A_3:"1002009",N23_A_1:"1002014",N24_A_1:"1002005",N24_A_2:"1002015",N24_A_3:"1002005",N24_A_4:"1002016",N21_A_1:"1002017",N21_A_2:"1002017",N21_A_3:"1002017",N41_A_1:"1002018",N50_A_1:"1002019",N212_A_1:"1002020",N212_A_2:"1002021",N212_A_3:"1002022",N212_A_4:"1002022",N212_A_9:"1002022",N212_A_10:"1002022",N212_A_11:"1002022",N212_A_12:"1002022",N212_A_13:"1002022",N212_B_1:"1002004",N212_B_2:"1002023",N212_B_3:"1002023",N212_B_4:"1002023",N212_B_5:"1002023",N212_B_6:"1002023",N212_B_7:"1002023",N212_B_8:"1002023",N212_B_9:"1002023",N212_B_10:"1002023",N212_B_11:"1002004",N212_B_12:"1002023",N212_B_13:"1002023",N212_B_14:"1002023",N212_B_16:"1002023",N212_B_17:"1002023",N212_B_18:"1002023"},get_errcode:function(e,t){var _="1002005",a=this;return app_tools.each(this.rule,function(s,n){var r=s.split("/");if(e.indexOf(r[0])>=0)return(!t||t.nns_func==r[1])&&(_=a.errcodeRule[n],!0)}),_},get_api_host_url:function(e,t){if(t){for(var a in _)if(_[a].indexOf(t)!=-1)for(var s in this.api_host)if(s.replace(/^API\_HOST\_/gi,"").toUpperCase()==a.toUpperCase())return e.replace(/^http.?\:\/\/[^/]+\//,this.api_host[s]);return null}return null},get_url:function(e){var t=a(e),_=t.baseUrl.split("/"),s=_[_.length-1],n=t.params.nns_func;t.params&&t.params.nns_func&&(s+="/"+t.params.nns_func);var r=t.baseUrl;t.params.nns_func&&(r+="/"+this.get_upper_word(t.params.nns_func),delete t.params.nns_func);var i={};for(var o in t.params){var c=this.get_upper_word(o);i[c]=t.params[o]}var u=this.get_api_host_url(r,n);if(u)r=u;else for(var l in this.rule)if(this.rule[l]==s&&this.cdns[l])return r=this.get_cdn_url(r,i,this.cdns[l]);return r=this.get_dy_url(r,i),r=r.indexOf("?")>-1?r+"&now="+(new Date).getTime():r+"?now="+(new Date).getTime()},get_upper_word:function(e){var e=e.replace(/nns\_/g,""),t=e.split("_");e="";for(var _ in t)"index"!=_&&(e+=t[_].substring(0,1).toUpperCase()+t[_].substring(1));return e},get_cdn_url:function(e,t,_){var a=0;for(var s in t)this.cdnexcept.index(s)==-1&&(e+=a<5?"--"+s+"__"+t[s]:e.indexOf("?")>0?"&"+s+"="+t[s]:"?"+s+"="+t[s],a++,5==a&&(e+=".shtml"));return e.indexOf(".shtml")<=0&&(e+=".shtml"),e=e.replace(/http:\/\/([^\/]+)\//,_)},get_dy_url:function(e,t){for(var _ in t)e+=e.indexOf("?")>0?"&"+_+"="+t[_]:"?"+_+"="+t[_];return e}};s.rule=_||{},e.interface_method=t,e.cdnRule=s}(window);try{console.log("test","Utility:",Utility),window.Utility=Utility}catch(e){window.Utility=!1,console.log("test","Utility:",Utility)}!function(window){function indexOf(e,t){for(var _=0,a=e.length;_<a;_++)if(e[_]==t)return _;return-1}function get_url_params(){for(var e=location.search.slice(1),t=""!=e?e.split("&"):[],_={},a=0;a<t.length;a++){var s=t[a].indexOf("=");if(s!=-1){var n=t[a].substring(0,s),r=t[a].substring(s+1);r=r?decodeURIComponent(r):util.change_null_to_space(r),_[n]=r}}return _}function is_function(e){return"function"==typeof e}function clone(e,t){e&&"object"==typeof e||(e=t);for(var _ in t)t.hasOwnProperty(_)&&t[_]&&(e[_]=t[_])}function set_cookie(e,t){t=encodeURIComponent(jsonToString(t)),window.localStorage?window.localStorage.setItem(e,t):document.cookie=e+"="+t}function get_cookie(e){return e=e||"middle_user_info",null}function jsonToString(e){switch(typeof e){case"string":return'"'+e.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+e.map(jsonToString).join(",")+"]";case"object":if(e instanceof Array){for(var t=[],_=e.length,a=0;a<_;a++)t.push(jsonToString(e[a]));return"["+t.join(",")+"]"}if(null==e)return"null";var s=[];for(var n in e)s.push(jsonToString(n)+":"+jsonToString(e[n]));return"{"+s.join(",")+"}";case"number":return e;case"boolean":return e}}function stringToJson(data){var json={};return"string"==typeof data?json=eval("("+data+")"):"object"==typeof data&&(json=eval(data)),json}function str2time(e){return e=e.replace(/[-:T ]/g,"").substr(0,14)}function request(e,t,_,a){var s={};"string"==typeof _&&(a=_),"function"==typeof t?_=t:s=t,a=a||s.nns_func;var t=baseFunc.get_base_post_data(a,s);"N40_A"!=e||t.nns_user_id||(t.nns_user_id=t.nns_device_id),console.log("test","web_token_________",t.nns_webtoken),console.log("test","nns_user_id_________",t.nns_user_id),ajax_v2.get_data(e,t,function(t){console.log("interface","-------",e,"-------------:",t.result&&t.result.reason),"function"==typeof _&&_(t)})}var baseFunc={},ajax_v2=window.nw_ajax_v2,starcorExt=window.starcorExt,utility=window.Utility,interface_method=window.interface_method;baseFunc.base_time="",baseFunc.base_params={service_type:"ip",tag:26},baseFunc.init=function(){var e=get_url_params();baseFunc.base_params.cp_id=e.cp_id,baseFunc.base_params.service_type=e.service_type||baseFunc.base_params.service_type,starcorExt?(baseFunc.base_params.env="starcor",this.starcor_apk()):(baseFunc.base_params.env="other",utility?this.utility_apk(utility):this.test_utility_apk_v2()),this.has_stb_url(function(){baseFunc.init_auth_token(),baseFunc.init_ready_callback()})};var timer_c="";baseFunc.init_ready_callback=function(e){clearInterval(timer_c),is_function(baseFunc.ready_callback)?baseFunc.ready_callback(e):timer_c=setInterval(function(){clearInterval(timer_c),baseFunc.init_ready_callback(e)},50)},baseFunc.init_auth_token=function(){this.Interval_updata_token(this.get_base_post_data("scaaa_refresh_token"))},baseFunc.starcor_apk=function(){var e=starcorExt;starcorExt={_setCallbackResult:function(t,_){e._setCallbackResult(t,_)},_execAndroidFunc:function(t,_){return e._execAndroidFunc(t,_)}},starcorExt._invokeCallback=function(e,t,_){var a=this._callbacks[e],s=null;try{var n=[];for(var r in t){var i=t[r];switch(i.type){case"number":n.push(Number(i.value));break;case"string":n.push(String(i.value));break;case"boolean":n.push("true".toLowerCase()==i.value)}}s=a.apply(this,n)}catch(e){}starcorExt._setCallbackResult(_,s)},starcorExt._addCallback=function(e){var t=String(starcorExt._callback_counter++);return this._callbacks[t]=e,t},starcorExt._callback_counter=0,starcorExt._callbacks={},starcorExt.exec=function(){for(var e=[],t=0;t<arguments.length;++t){var _=arguments[t];switch(typeof _){case"number":e.push({type:"number",value:_});break;case"string":e.push({type:"string",value:_});break;case"bool":e.push({type:"boolean",value:_});break;case"object":e.push({type:"object",value:_});break;case"function":e.push({type:"callback",value:this._addCallback(_)})}}var a=e.shift();return"undefined"==typeof this._execAndroidFunc?null:this._execAndroidFunc(a.value,JSON.stringify(e))},starcorExt.readSystemProp=function(e){return String(this.exec("readSystemProp",e))},starcorExt.closeBrwoser=function(e){if(e)return this.exec("closeBrowser",e)},starcorExt.getServerTime=function(){return String(this.exec("getServerTime"))},starcorExt.getTokenInfo=function(){return String(this.exec("getTokenInfo"))},starcorExt.getEpgInterfaceData=function(){return String(this.exec("getEpgInterfaceData"))},starcorExt.sendIntent=function(e,t){return this.exec("sendIntent",e,t)},baseFunc.get_starcor_base(starcorExt)},baseFunc.utility_apk=function(e){var t=baseFunc.base_params;t.device_id=e.getSystemInfo("SID")||"",t.mac_id=t.device_id,t.version=cpcom_config.version,t.epg_host=cpcom_config.epg_host},baseFunc.test_utility_apk_v2=function(){baseFunc.base_params.device_id="8851003052001697",baseFunc.base_params.mac_id=baseFunc.base_params.device_id,baseFunc.base_params.version=cpcom_config&&cpcom_config.version,baseFunc.base_params.epg_host=cpcom_config&&cpcom_config.epg_host},baseFunc.get_starcor_base=function(e){baseFunc.base_params.web_token=e.readSystemProp("user.token"),baseFunc.base_params.version=e.readSystemProp("app.version"),baseFunc.base_params.device_id=e.readSystemProp("device.id"),baseFunc.base_params.mac_id=e.readSystemProp("device.mac"),baseFunc.base_params.user_id=e.readSystemProp("user.id"),console.log("info","user_id:"+baseFunc.base_params.user_id),console.log("info","device_id:"+baseFunc.base_params.device_id),console.log("info","web_token:"+baseFunc.base_params.web_token);try{baseFunc.stb_url=e.getEpgInterfaceData(),console.log("test","stb_url:"+baseFunc.stb_url),baseFunc.base_params.token_info=e.getTokenInfo();var t=JSON.parse(e.getTokenInfo());baseFunc.base_params.valid_time=t.valid_time||"",baseFunc.base_params.refresh_time=t.refresh_time,console.log("test","refresh_time:"+baseFunc.base_params.refresh_time)}catch(e){}},baseFunc.get_base_post_data=function(e,t){var _=this.base_params,a={nns_device_id:_.device_id,nns_smart_card:_.device_id,nns_tag:_.tag,nns_version:_.version};return _.cp_id&&(a.nns_cp_id=_.cp_id),_.service_type&&(a.nns_service_type=_.service_type),_.mac_id&&(a.nns_mac_id=_.mac_id),_.web_token&&(a.nns_webtoken=_.web_token),_.user_id&&(a.nns_user_id=_.user_id),"string"==typeof e?a.nns_func=e:t=e,t&&clone(a,t),a},baseFunc.get_system_time=function(e){if(starcorExt){var t=str2time(starcorExt.getServerTime());e(t)}else nw_ajax_v2.get_data("N2_A",{nns_func:"sync_time"},function(t){e(str2time(t.time))})},baseFunc.has_base_data=function(e){var t=this.base_params;if(console.log("test","has_base_data env",t.env),"starcor"==t.env)return void(is_function(e)&&e());var _=t.web_token,a=t.device_id;if(!_||!a){var s=get_cookie(),n=s&&s.web_token,r=s&&s.device_id;(a||r)&&(_||n?(_||(t.web_token=n,t.valid_time=s.valid_time,t.refresh_time=s.refresh_time),!a&&(t.device_id=r),!t.user_id&&s.user_id&&(t.user_id=s.user_id),this.token_is_effective(this.get_base_post_data("scaaa_device_auth"),e)):this.updata_token(this.get_base_post_data("scaaa_device_auth"),e))}},baseFunc.analysis_N1_interface=function(e){function t(e,t){var n="cdns"==t,r=n?"c_":"a_",i=n?0:9;for(var o in e)if("group"!=o&&indexOf(a,o.substr(i,o.indexOf("_")).toUpperCase())!=-1){var c=e[o];s[t][o]=c;var u=indexOf(_[r+"u"],c);u==-1&&(_[r+"u"].push(c),u=_[r+"u"].length-1),_[r+"m"][o]=u}}if(e){var _={b_u:[],c_u:[],a_u:[],b_m:{},c_m:{},a_m:{},d:[]},a=["N39","N40","N50","N51","N215","N2","N36","N3","N24"],s=window.cdnRule;for(key in e){var n=e[key];if("parameter_list"!==key&&"header"!==key){if(indexOf(a,key.substr(0,key.indexOf("_")).toUpperCase())!=-1){var r=key.toUpperCase();ajax_v2.urls[r]=n.url;var i=0;for(b_item in n)if("url"==b_item){var o=n[b_item]||"",c=o.match(/^http.?\:\/\/[^/]+\//)[0],u=o.replace(/^http.?\:\/\/[^/]+\//,"").replace(/(.*)\/{1}.*/,"$1");i=indexOf(_.b_u,c),i==-1&&(_.b_u.push(c),i=_.b_u.length-1),index_d=indexOf(_.d,u),index_d==-1&&(_.d.push(u),index_d=_.d.length-1),_.b_m[key]=[i,index_d]}}}else if("parameter_list"==key&&n&&n.length>0)for(var l=0,d=n.length;l<d;l++){var p=n[l];"CDN"==p.group?t(p,"cdns"):"API_HOST"==p.group&&t(p,"api_host")}}set_cookie("stb_url",_)}},baseFunc.analysis_N1_cookie=function(e){var t=stringToJson(e),_=window.cdnRule;if(t){var a=t.b_m,s=t.b_u,n=t.d;for(var r in a){var i=a[r],o=r.toUpperCase();ajax_v2.urls[o]=s[i[0]]+n[i[1]]+"/"+interface_method[o]}var c=t.c_m,u=t.c_u;for(r in c)_.cdns[r]=u[c[r]];var l=t.a_m,d=t.a_u;for(r in l)_.api_host[r]=d[l[r]]}},baseFunc.has_stb_url=function(e){var t=this.stb_url||get_cookie("stb_url"),_=this.base_params;t?(this.stb_url?(console.log("test","stb_url   starcor apk"),this.analysis_N1_interface(JSON.parse(t))):(console.log("test","stb_url  cooke"),this.analysis_N1_cookie(t)),console.log("test","check  has_base_data"),this.has_base_data(e)):(console.log("test","get_base_data"),ajax_v2.get_base_data(_.epg_host,function(t){baseFunc.analysis_N1_interface(t),baseFunc.has_base_data(e)}))},baseFunc.token_is_effective=function(e,t){var _=this.base_params;this.get_system_time(function(a){a>str2time(_.valid_time)?(_.web_token="",baseFunc.updata_token(e,t)):t()})},baseFunc.has_web_token=function(){var e=get_cookie();e&&e.web_token||this.update_token()},baseFunc.updata_token=function(e,t){var _=this.base_params;ajax_v2.get_data("N215_A",e,function(e){if(console.log("test","updata_token_res __:",e.result.state),3e5==e.result.state){var a=e.auth;_.web_token=a.web_token,_.valid_time=a.valid_time,_.refresh_time=a.refresh_time,e.user&&e.user.id&&(_.user_id=e.user.id),set_cookie("middle_user_info",_),t(e)}})},baseFunc.Interval_updata_token=function(e){var t=baseFunc.base_params,_=window.setTimeout(function(){if(console.log("test","in Interval_updata_token________",baseFunc.base_params.env),"starcor"==baseFunc.base_params.env){console.log("test","Interval_updata_token________",_);var a=stringToJson(starcorExt.getTokenInfo());t.web_token=a.webtoken,t.valid_time=a.valid_time,t.refresh_time=a.refresh_time,set_cookie("middle_user_info",t),clearTimeout(_),baseFunc.Interval_updata_token(e)}else baseFunc.updata_token(e,function(){clearTimeout(_),e.nns_webtoken=t.web_token,baseFunc.Interval_updata_token(e)})},1e3*baseFunc.base_params.refresh_time)};var starcorCom={};starcorCom.get_cp_id=function(){return baseFunc.base_params.cp_id},starcorCom.get_version=function(){return baseFunc.base_params.version},starcorCom.get_token=function(){return baseFunc.base_params.web_token},starcorCom.get_env=function(){return baseFunc.base_params.env},starcorCom.get_tag=function(){return baseFunc.base_params.tag},starcorCom.get_user_id=function(){return baseFunc.base_params.user_id},starcorCom.get_epg_host=function(){return baseFunc.base_params.epg_host},starcorCom.get_device_id=function(){return baseFunc.base_params.device_id},starcorCom.get_service_type=function(){return baseFunc.base_params.service_type},starcorCom.auth_play=function(e,t){e.nns_func="check_auth_by_media",request("N51_A",e,t)},starcorCom.apply_play=function(e,t){e.nns_func="check_auth_and_get_media_by_media",request("N51_A",e,t)},starcorCom.get_collect_list=function(e,t){request("N40_A",e,t,"get_collect_list_v2")},starcorCom.add_collect=function(e,t){request("N40_A",e,t,"add_collect_v2")},starcorCom.delete_collect=function(e,t){request("N40_A",e,t,"delete_collect_v2")},starcorCom.get_playlist=function(e,t){request("N40_A",e,t,"get_playlist_v2")},starcorCom.add_playlist=function(e,t){request("N40_A",e,t,"add_playlist_v2")},starcorCom.delete_playlist=function(e,t){request("N40_A",e,t,"delete_playlist_v2")},starcorCom.get_catch_list=function(e,t){request("N40_A",e,t,"get_catch_list_v2")},starcorCom.add_catch=function(e,t){request("N40_A",e,t,"add_catch_v2")},starcorCom.delete_catch=function(e,t){request("N40_A",e,t,"delete_catch_v2")},starcorCom.get_special_info=function(e,t){request("N24_A",e,t,"get_special_info")},starcorCom.get_special_item_list=function(e,t){request("N24_A",e,t,"get_special_item_list")},starcorCom.search_special_item=function(e,t){request("N24_A",e,t,"search_special_item")},starcorCom.get_special_online=function(e,t){request("N24_A",e,t,"get_special_online")},starcorCom.get_special_info_by_ids=function(e,t){request("N24_A",e,t,"get_special_info_by_ids")},starcorCom.get_home_data=function(e,t){request("N36_A",e,t,"get_init_meta_data")},starcorCom.get_media_assets_class=function(e,t){request("N39_A",e,t,"get_media_assets_info_v2")},starcorCom.get_media_assets_list=function(e,t){request("N39_A",e,t,"get_media_asset_list_v2")},starcorCom.get_media_assets_bind_labels=function(e,t){request("N39_A",e,t,"get_media_assets_bind_labels_v2")},starcorCom.get_media_assets_list_by_labels=function(e,t){request("N3_A_D",e,t,"get_media_assets_item_by_labels")},starcorCom.get_video_info=function(e,t){request("N39_A",e,t,"get_video_info_v3")},starcorCom.get_video_recom_video=function(e,t){request("N39_A",e,t,"get_video_recom_video")},starcorCom.get_video_index_list=function(e,t){request("N39_A",e,t,"get_video_index_list")},starcorCom.search_media_assets=function(e,t){request("N39_A",e,t,"search_media_assets_item_v2")},starcorCom.go_starcor_play=function(e){var t={action:"com.starcor.gzgd.app.general.action",extras:{source:"com.starcor.gzgd.app",data:{cmd:"playVideo",cp_video_id:e.video_id,cp_video_index:e.video_index||0,position:e.position||0,source:e.source||"other"}},flags:["INCLUDE_STOPPED_PACKAGES"]};starcorExt.sendIntent("sendBroadcast",t)},starcorCom.go_pay=function(e,t){if("starcor"==starcorCom.get_env()){var _={action:"com.starcor.gzgd.app.authorities.pay",extras:{cp_id:"10019",package_name:e.package_name,session_id:e.session_id,cp_video_id:e.cp_video_id,cp_index_id:e.cp_index_id,cp_source_id:e.cp_source_id,video_id:e.video_id,video_index:e.video_index,video_source_id:e.video_source_id,products:e.products,ex_data:e.ex_data},flags:["NEW_TASK"]};console.log("test","send inrent"),is_function(t)&&(starcorCom.pay_result_callback=t),starcorExt.sendIntent("sendBroadcast",_)}},starcorCom.on_purchase_vip_result=function(e){is_function(starcorCom.pay_result_callback)&&starcorCom.pay_result_callback(e)},starcorCom.exit=function(){starcorExt?starcorExt.closeBrwoser("back"):setTimeout(function(){window.history.go(-1)},10)},starcorCom.bind_key=function(e){function t(t){var _=t.which||t.keyCode;if(_){switch(_){case 27:case 8:t.key_name="esc";break;case 37:t.key_name="left";break;case 39:t.key_name="right";break;case 13:t.key_name="enter";break;case 38:t.key_name="up";break;case 40:t.key_name="down";break;case 32:t.key_name="menu"}e.bind_key(t)}}if(starcorExt)try{starcorExt.requestFocus(),starcorExt.setKeyEventHandler(function(t,_,a,s){console.log("test","____________keyName",a);var n={keyCode:_,key_name:a};e.bind_key(n)})}catch(t){document.onkeydown=function(t){var _=t||window.event||arguments.callee.caller.arguments[0];if(_){switch(_.keyCode){case 27:case 8:_.key_name="esc";break;case 37:_.key_name="left";break;case 39:_.key_name="right";break;case 13:_.key_name="enter";break;case 38:_.key_name="up";break;case 40:_.key_name="down";break;case 32:_.key_name="menu"}e.bind_key(_)}}}else utility?(console.log("test","in bind_key____________utility"),document.onirkeypress=t,document.onkeypress=t):document.onkeydown=function(t){var _=t||window.event||arguments.callee.caller.arguments[0];if(_){switch(_.keyCode){case 27:case 8:_.key_name="esc";break;case 37:_.key_name="left";break;case 39:_.key_name="right";break;case 13:_.key_name="enter";break;case 38:_.key_name="up";break;case 40:_.key_name="down";break;case 32:_.key_name="menu"}e.bind_key(_)}}},starcorCom.ready=function(e){baseFunc.ready_callback=e},baseFunc.reset_starcorCom=function(){starcorCom={},starcorCom.ready=function(e){baseFunc.ready_callback=e}},baseFunc.init(),window.starcorCom=starcorCom}(window);