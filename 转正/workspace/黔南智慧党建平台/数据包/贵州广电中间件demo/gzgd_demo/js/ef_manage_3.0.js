!function(t){function e(t){this.name=t,this.all_area={},this.focus_id="",this.last_key=""}e.$=function(e,o){var i=e;return 2===arguments.length&&(i=e+"__"+o),t.document.getElementById(i)},e.prototype.onkeydown=function(t){},e.prototype.on_cancel=function(t){},e.prototype.bind_key=function(t){function e(t){if(i.config&&i.config.length>0){var e=i.config[n];if(e.length>0){var s=e[t];null===s?i.trigger("focusout",o):a.set_focus(i.name,s)}return!0}return!1}if(null===this.onkeydown(t))return null;var o=t.key_name,i=this.get_area_obj();if("esc"==o||"cancel"==o)return console.log("t_html","in ef_manage bind_key:"),i?null!==i.trigger("cancel")?(console.log("t_html","in ef_manage bind_key __---area_obj:"),this.on_cancel()):(console.log("t_html","in ef_manage bind_key __---area_obj else:"),null):(console.log("t_html","in ef_manage bind_key __---else:"),this.on_cancel());if(i){var a=this;this.last_key=o;var n=i.idx-0;switch(o){case"up":e(0)||(n-=i.col,n>=0?this.set_focus(i.name,n):i.trigger("focusout",o));break;case"down":if(!e(2))if(n+=i.col,n<i.total)this.set_focus(i.name,n);else{var s=Math.ceil(i.total/i.col),l=Math.ceil((i.idx+1)/i.col);l===s?i.trigger("focusout",o):this.set_focus(i.name,i.total-1)}break;case"left":e(3)||(n%i.col===0?i.trigger("focusout",o):n>0&&(n--,this.set_focus(i.name,n)));break;case"right":e(1)||((n+1)%i.col===0?i.trigger("focusout",o):n<i.total-1?(n++,this.set_focus(i.name,n)):i.trigger("focusout",o));break;case"enter":i.trigger("click",o)}}},e.prototype.get_focus=function(t){var o;return o=t?e.$(t,this.get_area_obj(t).idx):e.$(this.focus_id)},e.prototype.set_focus=function(t,o){var i,a;if(1===arguments.length&&(i="object"==typeof t?t:this.get_focus(t))){var n=i.id.split("__");a=n[0],o=n[1]}if(arguments.length>1&&(a=t,i=e.$(t,o)),i){if(null!==this.kill_focus()){var s=this.focus_id;this.focus_id=i.id,this.get_area_obj(a).idx=o-0,i.className=i.className+" focused-item",this.get_area_obj().trigger("focus",this.last_key),s.split("__")[0]!=i.id.split("__")[0]&&this.get_area_obj(a).trigger("focusin",this.last_key)}i=null}},e.prototype.kill_focus=function(){var t=e.$(this.focus_id);if(t){if(null===this.get_area_obj().trigger("blur",this.last_key))return null;t.className=t.className.replace(" focused-item",""),t=null}},e.prototype.get_area_obj=function(t){return t||(t=this.focus_id.split("__")[0]),this.all_area[t]},e.prototype.update_area=function(t,e){var o=this.get_area_obj(t);return o.name&&(e.length>0?(o.config=e,o.total-e.length):(o.col=e.col||o.col,o.total=e.total||o.total,o.total<o.col&&(o.col=o.total),o.row=Math.ceil(o.total/o.col)),o.idx="undefined"==typeof e.idx?o.idx:e.idx),o},e.prototype.reset=function(t){if("undefined"==typeof t){var e=this.all_area;for(var o in e)e[o].idx=0}else for(var i=t.length,a=0;a<i;a++){var n=this.all_area[t[a]];n&&(n.idx=0)}},e.prototype.add_area=function(t,o){var i=this.all_area[t];return i?this.update_area(t,o):(i=new e.prototype.add_area.prototype.init(t,o),this.all_area[t]=i),i},e.prototype.add_area.prototype={init:function(t,e){return this.name=t,e.length>0?(this.config=e,this.total=e.length):(this.col=e.col-0,this.total=e.total-0,this.total<this.col&&(this.col=this.total),this.row=Math.ceil(this.total/this.col)),this.idx=e.idx||0,this.events={},this},on:function(t,e){return this.events[t]=e,this},trigger:function(t,o){var i=this.events[t];if("function"==typeof i)return i.call(this,e.$(this.name,this.idx),this.idx,o)}},e.prototype.add_area.prototype.init.prototype=e.prototype.add_area.prototype,t.ef_manage=e}(window);