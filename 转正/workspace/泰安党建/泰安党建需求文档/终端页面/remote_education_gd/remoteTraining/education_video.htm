<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style>
.btn{
	position:absolute;
	top:-1px;
	width:152px;
	height:48px;
	text-align:center;
	line-height:48px;
	font-size:30px;
	color:#927256;
	background:url(../images/btn11.png) no-repeat;
}
</style>
<title>党教视频</title>
<script src="../js/comm.js"></script>
<script language="javascript" type="text/javascript" src="data/signIn.js"></script>
<script language="javascript" type="text/javascript">
/**************变量区域*******************/
var opt;
var objArr=[];
var maxSize=12;

var url=window.location.href;

var subPos=0;
var totalPage = 0;      
var currPage = 0; 

var position=0;
var command;



/*********************按键操作区域********************/
document.onkeydown = eventHandler;
function eventHandler(key){
  var e = key || event;
  var keycode = e.keyCode || e.which || e.charCode;
  switch (keycode) {
    case 1:   // up
    case 38:
      upAndDown(-1);
      return false;
      break;
    case 2:   // down
    case 40:
      upAndDown(1);
      return false;
      break;
    case 3:   // left
    case 37:
      leftAndRight(-1);
      return false;
      break;
    case 4:   // right
    case 39:
      leftAndRight(1);
      return false;
      break;
    case 13:
      doSelect();
      return false;
      break;
    case 8:
		goBack();
    	event.returnValue = false;
    	return false;
    	break;
    case 27:
      //iSTB.browser.gotoSTB("tv");
      event.returnValue = false;
      return false;
      break;
  }
}

function leftAndRight(_num){
	if(_num>0){//右移
    if(subPos%(maxSize/2) == maxSize/2-1&&currPage<totalPage-1){
      changePage(_num);//至3，5位置
    }else{
      subPos = subPos+_num;//普通位置
    }
  }else{//左移
  	//左边位置  0
    if(subPos%(maxSize/2) == 0 && currPage>0){
      changePage(_num);
    }else{
      subPos = subPos+_num;
    }
  }
  if(subPos+currPage*maxSize>menuData.length-1) 
  	subPos = (menuData.length-1)%maxSize;
  if(subPos+currPage*maxSize<0) 
  	subPos = 0;
	initFocus();
}


function upAndDown(_num){
  if((maxSize/2-1)<subPos&&_num>0&&currPage<totalPage-1){
	  //下翻:处于第二排
    changePage(_num);
  }else if((maxSize/2)>subPos&&_num<0&&currPage>0){
	  //第一排上翻
    changePage(_num);
  }
  //翻页之后：初始化subPos的值
  subPos = (subPos+_num*(maxSize/2)+maxSize)%maxSize;
  //边界：下翻之后没有数据
  if(subPos+currPage*maxSize>menuData.length-1) subPos = (menuData.length-1)%maxSize;
  initFocus();
} 

function goBack(){
	if(command=="fromIndex"){
		window.location.href="../index.htm";
	}else if(command=="fromSelectFun"){
		window.location.href = "selectFun.htm?opt="+opt;
	}
}

function doSelect(){
	if(menuData[subPos+currPage*maxSize].url!=""){
		window.location.href="../play.htm?videoName="+encodeURI(menuData[subPos+currPage*maxSize].name)+"&playUrl="+menuData[subPos+currPage*maxSize].url+"&position="+(subPos+currPage*maxSize)+"??reUrl==memberService/education_video.htm?opt=1&command="+command;
	}
}


function changePage(_num){
	currPage+=_num;
	initContent();
}


function initFocus(){
	$("focus").style.top = Math.floor(subPos/(maxSize/2))*243+100+"px";
	$("focus").style.left = (subPos%(maxSize/2))*183+75+"px";
}

function init(){
	getParms();
	initObj();
	initContent();
	initFocus();
}

function getParms(){
	opt=getUrlArgs("opt",url);
	if(opt!=""){
		opt=parseInt(opt,10);
	}else{ 
		opt=0;
	}
	position=getUrlArgs("position",url);
	if(position!=""){
		position=parseInt(position,10);
		subPos=position%maxSize;
		currPage=Math.floor(position/maxSize);
	}else{
		position=0;
	}
	command=getUrlArgs("command",url);	
}

function initObj(){
	var imgObjnextStep,allDiv;
	for(var i=0;i<maxSize;i++){
		imgObj=$("image"+i);
		allDiv=$("div"+i);
		objArr.push({"imgObj":imgObj,"divObj":allDiv});
	}
}

function initContent(){	
  	totalPage = Math.ceil(menuData.length/maxSize);
    for(i=0;i<maxSize;i++){
		objArr[i].divObj.style.visibility="visible";
      if((currPage)*maxSize+i<menuData.length){
        objArr[i].imgObj.src = menuData[(currPage)*maxSize+i].image;
      }else{
		objArr[i].divObj.style.visibility="hidden";
      }
    }
}
    
</script>
</head>

<body leftmargin="0" topmargin="0" background="../images/bg.jpg" onload="init();">
<!--location-->
<div style="position: absolute; left: 465px; top: 47px; width: 138px; height: 33px; font-size: 30px; color: #000000;" id="title">党教视频</div>
<!--news
<div style="position:absolute; left:106px; top:658px;  width:773px; height:27px; font-size:26px; color:#a0aabd;  overflow:hidden; ">
      肥城市进一步健全工作机制,实行“责任实体化、推进项目化、考评具体化”,党组织书记带头创新落实,构建党的建设新常态。</div>
</div>
-->
<div style="position:absolute; left:92px; top:128px; width:1135px; height:491px;">
	<!--上排-->
	<div style="position:absolute; left:12px; top:0px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div0">
<img src="" width="163" height="221" style="position: absolute; left: 0px; top: 0px; height: 224px;" id="image0"/>
</div>
    
	<div style="position:absolute; left:195px; top:0px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div1">
  <img src="" width="163" height="223" style="position:absolute; left:0px; top:0px;" id="image1"/></div>
  
	<div style="position:absolute; left:378px; top:0px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div2">
  <img src="" width="163" height="223" style="position:absolute; left:0px; top:0px;" id="image2"/></div>
  
	<div style="position:absolute; left:561px; top:0px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div3">
	<img src="" width="163" height="176" style="position: absolute; left: 0px; top: 0px; height: 223px;" id="image3"/></div>
    
	<div style="position:absolute; left:744px; top:0px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div4">
	<img src="" width="163" height="223" style="position:absolute; left:0px; top:0px;" id="image4"/></div>
    
	<div style="position:absolute; left:927px; top:0px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div5">
<img src="" width="163" height="224" style="position:absolute; left:0px; top:0px;" id="image5"/></div>
    
    
 	<!--下排-->
	<div style="position:absolute; left:12px; top:243px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div6">
<img src="" width="163" height="223" style="position:absolute; left:0px; top:0px;" id="image6"/></div>
    
	<div style="position:absolute; left:195px; top:243px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div7">
<img src="" width="163" height="223" style="position:absolute; left:0px; top:0px;" id="image7"/></div>
  
	<div style="position:absolute; left:378px; top:243px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div8">
<img src="" width="163" height="223" style="position:absolute; left:0px; top:0px;" id="image8"/></div>
  
	<div style="position:absolute; left:561px; top:243px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div9">
<img src="" width="163" height="223" style="position:absolute; left:0px; top:0px;" id="image9"/></div>
    
	<div style="position:absolute; left:744px; top:243px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div10">
<img src="" width="163" height="225" style="position:absolute; left:0px; top:0px;" id="image10"/></div>
    
	<div style="position:absolute; left:927px; top:243px; width:163px; height:223px; background:url(../images/headerBtm.png) no-repeat;" id="div11">
	<img src="" width="163" height="223" style="position:absolute; left:0px; top:0px;" id="image11"/></div>
</div>

<!--焦点-->
<div style="position:absolute; left:75px; top:100px; width:221px; height:281px; background:url(../images/headerFocus.png) no-repeat; visibility:visible" id="focus"></div>

<div style="position:absolute; width:221px; height:281px; background:url(../images/headerFocus.png) no-repeat; left: 45px; top: 96px; visibility:hidden"></div>

</body>
</html>
