<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>数字键盘</title>
	<script type="text/javascript" src="js/keyevent.js"></script>
	<script>
		var inputValue = '', // 输入框的值
			keyFocusPos = 5, // 焦点位置
			keyValue = [ // 焦点对应的值
				{"keyFocusPos":0,"value":1},
				{"keyFocusPos":1,"value":2},
				{"keyFocusPos":2,"value":3},
				{"keyFocusPos":3,"value":0},
				{"keyFocusPos":4,"value":4},
				{"keyFocusPos":5,"value":5},
				{"keyFocusPos":6,"value":6},
				{"keyFocusPos":7,"value":'清空'},
				{"keyFocusPos":8,"value":7},
				{"keyFocusPos":9,"value":8},
				{"keyFocusPos":10,"value":9},
				{"keyFocusPos":11,"value":'确认'},
			];
		var defaults = {
				oriValue:'',
				callback:function(){},
				backmethod:function(){}
			};
		function init() {
			showFocus();
			loadData();
			initInput();
			initParam();
		}
		function extend(destination,source){
			for(var property in source){
				destination[property] = source[property];
			}
			return destination;
		}
		function initParam(o){
			if(parent.numDefaults){
				defaults = extend(parent.numDefaults,o || {});
			}
			else{
				defaults = extend(defaults,o || {});
			}
			inputValue = defaults.oriValue;
			initInput();
		}
		function loadData() { // 动态写入值
			for(var keyFocusPos = 0; keyFocusPos < 12; keyFocusPos++) {
				$('key_'+keyFocusPos).innerText = keyValue[keyFocusPos].value;
			}
		}
		function initInput() {
			// iPanel.eventFrame.numKeyBoardValue = inputValue; // 用户输入值
			$('inputValue').innerText = inputValue; // 用户输入值
		}
		 //document.onkeydown = eventHandler;
		function eventHandler(eventObj){
			 //var e = key || event;
			 //var keycode = e.keyCode || e.which || e.charCode;
		    switch (eventObj.code) {
		    case "KEY_UP":   // up
				changeUD(-4);
				return false;
				break;
		    case "KEY_DOWN":   // down
				changeUD(4);
				return false;
				break;
		    case "KEY_LEFT":   // left
		    	changeLR(-1);
				return false;
				break;
		    case "KEY_RIGHT":   // right
				changeLR(1);
				return false;
				break;
		    case "KEY_SELECT": // 确定
		    	doSelect();
				return false;
				break;
		    case "KEY_BACK": // 返回
				deleteOrBack();
				return false;
				break;
			case "KEY_MENU"://菜单	
			case "KEY_HOMEPAGE":	//主页	
				if(typeof defaults.backmethod) {
					defaults.backmethod();
				}
				return false;
				break;
		    }
		}

		function changeUD(_num) {
			loseFocus();
			keyFocusPos += _num;
			if(keyFocusPos < 0) {
				keyFocusPos = 11;
			}else if(keyFocusPos ==15  && _num > 0) {
				keyFocusPos = 3;
			} else if(keyFocusPos > 11) {
				keyFocusPos = 11;
			}
			showFocus();
		}
		function changeLR(_num) {
			loseFocus();
			keyFocusPos += _num;
			if(keyFocusPos < 0) {
				keyFocusPos = 11;
			} else if(keyFocusPos == 11 && _num > 0) {
				keyFocusPos = 7;
			} else if(keyFocusPos > 11) {
				keyFocusPos = 11;
			}
			showFocus();
		}
		function doSelect() {
			if(keyFocusPos == 11) { // 确定 关键盘
				initInput();
				// iPanel.debug('gogogo---wuqx--numInput.htm--doSelect()--iPanel.eventFrame.numKeyBoardValue='+iPanel.eventFrame.numKeyBoardValue);
				if(typeof defaults.callback) {
					defaults.callback(inputValue);
				}
				//iPanel.pageWidgets.getByName("inputWidgets1.2").minimize();
				//$('numInput').style.visibility = 'hidden';
			} else if(keyFocusPos == 7) { // 清空
				$('inputValue').innerText = '';
				inputValue = '';
			} else if(keyFocusPos != 7 || keyFocusPos != 11) {
				//控制下长度
				if(inputValue.length <= 19){
					inputValue += keyValue[keyFocusPos].value; // 输入值拼接
					initInput();
				}
			}
		}
		function deleteOrBack() {
			if(inputValue.length == 0) { // 关键盘
				initInput();
				if(typeof defaults.backmethod) {
					defaults.backmethod();
				}
				//iPanel.pageWidgets.getByName("inputWidgets1.2").minimize();
				//$('numInput').style.visibility = 'hidden';
			} else {
				inputValue = inputValue.substring(0,inputValue.length-1);
				initInput();
			}
		}
		function loseFocus() {
			$('key_'+keyFocusPos).style.backgroundColor = '#7C931D';
			$('key_'+keyFocusPos).style.color = '#fff';
		}
		function showFocus() {
			$('key_'+keyFocusPos).style.backgroundColor = '#ffb400';
			$('key_'+keyFocusPos).style.color = '#333';
		}
		function $(_id) {
			return document.getElementById(_id);
		}
	</script>
</head>

<body onload="init();" bgcolor="transparent" style="width:1280px;height:720px;position:absolute;margin:0px;padding:0px;">
	<div id='numInput' style="width:1280px;height:240px;background-color:#7C931D;position:absolute;top:480px;left:0px;">
		<div id='inputValue' style="position:absolute;width:1125px;height:60px;border-bottom:1px solid #5F740C;line-height:60px;color:#fff;font-size:28px;text-indent:50px;background-color:#6F8512;"></div>
		<div id='key_11' style="position:absolute;width:154px;height:60px;border-bottom:1px solid #5F740C;line-height:60px;color:#fff;font-size:26px;text-indent:30px;left:1125px;border-left:1px solid #5F740C;">确定</div>
		<div id='key_0' style="position:absolute;width:334px;height:58px;border-bottom:1px solid #5F740C;line-height:58px;color:#fff;font-size:28px;text-indent:30px;top:61px;text-align:center;">1</div>
		<div id='key_1' style="position:absolute;width:304px;height:58px;border-bottom:1px solid #5F740C;line-height:58px;color:#fff;font-size:28px;top:61px;text-align:center;border-left:1px solid #5F740C;left:334px;">2</div>
		<div id='key_2' style="position:absolute;width:304px;height:58px;border-bottom:1px solid #5F740C;line-height:58px;color:#fff;font-size:28px;top:61px;text-align:center;border-left:1px solid #5F740C;left:638px;">3</div>
		<div id='key_3' style="position:absolute;width:334px;height:58px;border-bottom:1px solid #5F740C;line-height:58px;color:#fff;font-size:28px;text-indent:-20px;top:61px;text-align:center;border-left:1px solid #5F740C;right:2px;">0</div>
		<div id='key_4' style="position:absolute;width:334px;height:58px;border-bottom:1px solid #5F740C;line-height:58px;color:#fff;font-size:28px;top:120px;text-align:center;text-indent:30px;">4</div>
		<div id='key_5' style="position:absolute;width:304px;height:58px;border-bottom:1px solid #5F740C;line-height:58px;color:#fff;font-size:28px;top:120px;text-align:center;border-left:1px solid #5F740C;left:334px;">5</div>
		<div id='key_6' style="position:absolute;width:304px;height:58px;border-bottom:1px solid #5F740C;line-height:58px;color:#fff;font-size:28px;top:120px;text-align:center;border-left:1px solid #5F740C;left:638px;">6</div>
		<div id='key_7' style="position:absolute;width:334px;height:119px;line-height:119px;color:#fff;font-size:24px;text-indent:-20px;top:120px;text-align:center;border-left:1px solid #5F740C;right:2px;">清空</div>
		<div id='key_8' style="position:absolute;width:334px;height:59px;line-height:59px;color:#fff;font-size:28px;top:180px;text-align:center;text-indent:30px;">7</div>
		<div id='key_9' style="position:absolute;width:304px;height:59px;line-height:59px;color:#fff;font-size:28px;top:180px;text-align:center;border-left:1px solid #5F740C;left:334px;">8</div>
		<div id='key_10' style="position:absolute;width:304px;height:59px;line-height:59px;color:#fff;font-size:28px;top:180px;text-align:center;border-left:1px solid #5F740C;left:638px;">9</div>
	</div>
</body>
</html>