<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>01首页</title>
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript">
var menuAjaxPath = "menu.js";
var ajaxObj = null;
var menuPos = 0;
var picData = [
				{pic:"images/menu01.png",focusPic:"images/menu01_f1.png"},
				{pic:"images/menu02.png",focusPic:"images/menu02_f1.png"},
				{pic:"images/menu03.png",focusPic:"images/menu03_f1.png"},
				{pic:"images/menu04.png",focusPic:"images/menu04_f1.png"}
];
var menuData;
document.onkeydown = eventHandler;
document.onsystemevent = eventHandler;
function eventHandler(keycode) {
    var e = keycode || event;
    var keycode = e.keyCode || e.which || e.charCode;
    switch (keycode) {
    	case 1:
    	case 38:
			return false;
			break;
		case 2:
		case 40:
			return false;
			break;
		case 3:
		case 37:
			changeMenu(-1);
			return false;
			break;
		case 4:
		case 39:
			changeMenu(1);
			return false;
			break;
		case 13:
			doSelect();
			return false;
			break;
		case 8:
		case 27:
		case 340:
		case 32:
		case 339:
		case 640:
			setGlobalVar("hsIndexMenuPos","");
			iSTB.browser.gotoSTB("tv");
      		event.returnValue = false;
		    return false;
			break;
	}
}

function doSelect() {
  setGlobalVar("hsIndexMenuPos",menuPos + "");
  filePath = menuData[menuPos].nodePath;          //分类文件夹的名称
  if(filePath.indexOf("/") > -1){
    var tempArr = filePath.split("/");
    filePath = tempArr[tempArr.length - 1];
  }
  window.location.href = filePath + "/index.htm";
}

function changeMenu(_num) {
	if(menuPos + _num >= 0 && menuPos + _num < dataSize){
		blurFocus();
		menuPos = menuPos + _num;
		getFocus();
	}
}

function getFocus() {
	$("focus" + menuPos).style.visibility = "visible";
}

function blurFocus() {
	$("focus" + menuPos).style.visibility = "hidden";
}
function ajaxLoadMenuData() { 
	ajaxObj = null;
	if (ajaxObj != null) { 
		ajaxObj.requestAbort(); 
	}
	ajaxObj = new AjaxClass(); 
	ajaxObj.frame = window; 
	ajaxObj.charset = "gbk";
	ajaxObj.successCallback = function(_xmlHttp, _params) {
		var jsonData = eval('(' + _xmlHttp.responseText + ')'); 
		if(typeof(jsonData) != "undefined" && jsonData.length > 0) { 
			menuData = jsonData; 
			initList();
			getFocus();	
		}
	}
	ajaxObj.failureCallback = function(_xmlHttp, _params) { 
	}; 
	ajaxObj.url = menuAjaxPath;
	ajaxObj.requestData();
}

function getParams() {
	var mPos = getGlobalVar("hsIndexMenuPos");
	if(mPos != "" && mPos != "NaN" && mPos != null){
		menuPos = parseInt(mPos,10);
	}
	mPos = 0;
} 
var itemBox = null;
var dataSize = 4;
function initList() {
	for(var i = 0; i < dataSize;i++){
		$("menu" + i).src = picData[i].pic;
	}
	for(var i = 0; i < dataSize;i++){
		$("focus" + i).src = picData[i].focusPic;
	}
}
function init() {
	getParams();
	ajaxLoadMenuData();
}
</script>
</head>
<body background="images/bg.jpg" leftmargin="0" topmargin="0" onload= "init()">
	<div style="position:absolute;left:104px;top:136px; width:1071px; height:87px;"><img src="images/title01.png" width="1071" height="87"></div>
    
    <div style="position:absolute;left:104px;top:348px; width:274px; height:274px;"><img id="menu0" src="" width="274" height="274"></div>
    <div style="position:absolute;left:365px;top:478px; width:215px; height:215px;"><img id="menu1" src="" width="215" height="215"></div>
    <div style="position:absolute;left:579px;top:313px; width:343px; height:343px;"><img id="menu2" src="" width="343" height="343"></div>
    <div style="position:absolute;left:931px;top:411px; width:252px; height:252px;"><img id="menu3" src="" width="252" height="252"></div>

    <!--焦点-->
    <div style="position:absolute;left:104px;top:348px; width:274px; height:274px;visibility: hidden;"><img id="focus0" src="" width="274" height="274"></div>
    <div style="position:absolute;left:365px;top:478px; width:215px; height:215px; visibility: hidden;"><img id="focus1" src="" width="215" height="215"></div>
    <div style="position:absolute;left:579px;top:313px; width:343px; height:343px; visibility: hidden;"><img id="focus2" src="" width="343" height="343"></div>
    <div style="position:absolute;left:931px;top:411px; width:252px; height:252px; visibility: hidden;"><img id="focus3" src="" width="252" height="252"></div>    
</body>
</html>
