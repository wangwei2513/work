<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<meta name="page-view-size" content="1280*1020">
<title></title>
<style>
    body,div,ul,li{margin:0;padding:0;}
    ul{list-style-type:none;}
    .count{position:absolute;right:10px;bottom:6px;}
	.count li{display:inline-block;margin:3px;width:15px;height:14px;}
	/* //#itemFocus{position:absolute; top:190px; left:555px;  visibility: visible;} */
</style>
</head>
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript" src="js/picRun.js"></script>
<script type="text/javascript">
var focusInfo = [ 
	{"up":-1,"right":2,"down":4,"left":-1,posInfo:{"left":78,"top":123,"width":563,"height":315}},
	{"up":-1,"right":-1,"down":-1,"left":-1,posInfo:{"left":926,"top":117,"width":272,"height":314}},
	{"up":-1,"right":3,"down":3,"left":0,posInfo:{"left":644,"top":117,"width":275,"height":155}},
	{"up":2,"right":4,"down":6,"left":0,posInfo:{"left":644,"top":280,"width":275,"height":155}},
	{"up":0,"right":5,"down":-1,"left":-1,posInfo:{"left":72,"top":441,"width":363,"height":155}},
	{"up":0,"right":6,"down":-1,"left":4,posInfo:{"left":440,"top":441,"width":198,"height":155}},
	{"up":3,"right":7,"down":7,"left":5,posInfo:{"left":644,"top":441,"width":275,"height":155}},
	{"up":3,"right":-1,"down":-1,"left":6,posInfo:{"left":926,"top":441,"width":275,"height":155}}
];

var croImg = ["images/ppp1.png","images/ppp2.png","images/ppp3.png","images/ppp4.png"];

//预加载tabImg图片
(function(){
	for(var i=1,len = croImg.length;i < len;i++){
		var img = new Image();
		img.src = croImg[i];
	}
})();	

var menuPos = 2;						// 焦点所在位置
var ajaxObj = null;
var menuAjaxPath = "menu.js";
var titleAjaxPath = "node.js";
var menuData = [];
var filePath = "";

var ajaxj = null;
function ajaxFooter(){         			// 设置跑马灯
        if (ajaxj != null) {
            ajaxj.requestAbort();
        }
        ajaxj = new AjaxClass();
        ajaxj.frame = window;
        ajaxj.charset = "gb2312";
        ajaxj.successCallback = function(_xmlHttp, _params) {
            var jsonData = eval('(' + _xmlHttp.responseText + ')');
            if(typeof(jsonData) != "undefined"){
                $("marqueeContent").innerText = jsonData.entryWord;
            }
        };
        ajaxj.failureCallback = function(_xmlHttp, _params) {  
        };
        ajaxj.url = titleAjaxPath;
        ajaxj.requestData();
}

document.onkeydown = grabKeyEvent;
function grabKeyEvent(keycode){
    var e = keycode || event;
    var keycode = e.keyCode || e.which || e.charCode;
	switch(keycode){
		case 1:
		case 38://up
			changeFocus("up");
			return false;
			break;
		case 2:
		case 40://down
			changeFocus("down");
			return false;
			break;
		case 3:
		case 37://left
			changeFocus("left");
			return false;
			break;
		case 4:
		case 39://right
			changeFocus("right");
			return false;
			break;
		case 13://ok
			doSelect();
			break;
	    case 8:
	    case 27:
	    case 32:
	    case 340:
	    case 339:
	    case 640:
			setGlobalVar("mlbhPos","");
			window.history.go(-1);
			return false;
			break;
	}
}	

function doSelect(){
	if(menuPos == 7) {					// 雪亮工程
		window.location.href = "";
		return;
	}
	if(menuPos >= 2){
		filePath = menuData[menuPos-2].nodePath;   
	  	if(filePath.indexOf("/") > -1){
	    	var tempArr = filePath.split("/");
	    	filePath = tempArr[tempArr.length-1];
	  	}
	  	setGlobalVar("mlbhPos",menuPos + "");
	  	window.location.href = filePath + "/index.htm";		
	}
}

function changeFocus(_flag){					// 焦点位置改变
	clearFocus();
	var newPos = focusInfo[menuPos][_flag];
	if(menuPos == 1)return;						// 前面两张图片是海报跟二维码
	if(newPos != -1){
		menuPos = newPos;
	}
	showFocus();
}

function clearFocus(){
	if(menuPos == 0)return;
	var posInfo = focusInfo[menuPos].posInfo;
	$("tabImg" + menuPos).style.width = parseInt($("tabImg" + menuPos).style.width) - 6 + "px";;
	$("tabImg" + menuPos).style.height = parseInt($("tabImg" + menuPos).style.height) - 6 + "px";
	$("tabImg" + menuPos).style.top = "0px";
	$("tabImg" + menuPos).style.left = "0px";
}

function showFocus(){
	var posInfo = focusInfo[menuPos].posInfo;
	$("itemFocus").style.left = posInfo.left - 49 + "px";	
	$("itemFocus").style.top = posInfo.top - 45 + "px";
	$("itemFocus").style.width = posInfo.width + 100 + "px";
	$("itemFocus").style.height = posInfo.height + 100 + "px";	
	if(menuPos == 0)return;
	$("tabImg" + menuPos).style.width = parseInt($("tabImg" + menuPos).style.width) + 6 + "px";
	$("tabImg" + menuPos).style.height = parseInt($("tabImg" + menuPos).style.height) + 6 + "px";
	$("tabImg" + menuPos).style.top = "-6px";
	$("tabImg" + menuPos).style.left = "-6px";
}

function initBasicData(){
	var html = "";										// 加载轮播图片
	for(var i = 0;i < croImg.length; i++) {
		html += "<div style='width:553px;height:315px;'><img src='"+ croImg[i] +"' width='563' height='315' /></div>";
	}
	$("inner").innerHTML = html;
	newPicPlay = new AutoPlay("tabImg0","inner");			// 显示图片轮播效果
}

function ajaxLoadMenuData(){
  if (ajaxObj != null) {
    ajaxObj.requestAbort();
  }
  ajaxObj = new AjaxClass();
  ajaxObj.frame = window;
  ajaxObj.charset = "gbk";
  ajaxObj.successCallback = function(_xmlHttp, _params) {
    	var jsonData = eval('(' + _xmlHttp.responseText + ')');
    	if(typeof(jsonData) != "undefined" && jsonData.length > 0){
	      	menuData = jsonData;
	      	showFocus();
    	}
	};
  ajaxObj.failureCallback = function(_xmlHttp, _params) {
  };
  ajaxObj.url = menuAjaxPath;
  ajaxObj.requestData();
}

function getParams(){
   var mmPos = getGlobalVar("mlbhPos");
   if(mmPos != "" && mmPos != "NaN" && mmPos !=null){
    	menuPos = parseInt(mmPos,10);
  	} 
}

function init() {
	getParams();
	ajaxLoadMenuData();
	initBasicData();
	//ajaxFooter();
}

window.onload = function() {
    init();
}
</script>
<body style="background:url(images/bg.png);background-repeat: no-repeat;background-color: transparent" topmargin="0" leftmargin="0">
	<div style="position:absolute;left:950px;top:47px; width:300px;font-size:32px; color:#263b3e;">毕节朱昌镇欢迎您！</div>
    <!-- 内容区 -->
	<!--轮播滚动部分-->
	<div id="tabImg0" style="position:absolute;left:78px;top:123px; width:563px; height:315px;">
		<div id="list" style="position:absolute;left:0px;top:0px;width:563px;height:315px;overflow:hidden;">
			<div id="inner" style='position:absolute;top:0px;left:0px;'>
			</div>
		</div>
	</div>

    <div style="position:absolute;left:932px;top:123px; width:100px; height:100px;"><img id="tabImg1" src="images/pic1_2.png" style="position:absolute;left:0px;top:0px; width:272px; height:314px;"></div>
    
    <div style="position:absolute;left:650px;top:123px; width:100px; height:100px;"><img id="tabImg2" src="images/pic1_3.png" style="position:absolute;left:0px;top:0px; width:272px; height:152px;"></div>

    <div style="position:absolute;left:650px;top:286px; width:100px; height:100px;"><img id="tabImg3" src="images/pic1_4.png" style="position:absolute;left:0px;top:0px; width:272px; height:152px;"></div>
    
    <div style="position:absolute;left:78px;top:447px; width:100px; height:100px;"><img id="tabImg4" src="images/pic1_5.png" style="position:absolute;left:0px;top:0px; width:360px; height:153px;"></div>
    
    <div style="position:absolute;left:446px;top:447px; width:100px; height:100px;"><img id="tabImg5" src="images/pic1_6.png" style="position:absolute;left:0px;top:0px; width:195px; height:152px;"></div>
    
    <div style="position:absolute;left:650px;top:447px; width:100px; height:100px;"><img id="tabImg6" src="images/pic1_7.png" style="position:absolute;left:0px;top:0px; width:272px; height:152px;"></div>
    
    <div style="position:absolute;left:932px;top:447px; width:100px; height:100px;"><img id="tabImg7" src="images/pic1_8.png" style="position:absolute;left:0px;top:0px; width:272px; height:152px;"></div>
    
    <!--跑马灯-->
	<div style="position:absolute;left:131px;top:625px; width:984px;line-height:50px; font-size:23px; color:#f0f0f0;">
		<marquee id="marqueeContent">毕节朱昌镇欢迎您！</marquee>
	</div>
	<!--焦点-->
	<div id="itemFocus" style="position:absolute;">
	  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
	    <tr>
	      <td width="80" height="80" background="images/focus_01.png">&nbsp;</td>
	      <td background="images/focus_02.png">&nbsp;</td>
	      <td width="80" background="images/focus_03.png">&nbsp;</td>
	    </tr>
	    <tr>
	      <td background="images/focus_04.png">&nbsp;</td>
	      <td>&nbsp;</td>
	      <td background="images/focus_05.png">&nbsp;</td>
	    </tr>
	    <tr>
	      <td height="80" background="images/focus_06.png">&nbsp;</td>
	      <td background="images/focus_07.png">&nbsp;</td>
	      <td background="images/focus_08.png">&nbsp;</td>
	    </tr>
	 </table>
	</div>
</body>
</html>
